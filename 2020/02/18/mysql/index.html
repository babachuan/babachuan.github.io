<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="探索、总结、理论、实践"><meta name="keywords" content="it, java, 测试"><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style-dark.css?v=2.0.5"><link rel="stylesheet" type="text/css" href="/css/highlight-dark.css?v=2.0.5"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><title>mysql | quhaichuan</title><meta name="generator" content="Hexo 4.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">mysql</h1><a id="logo" href="/.">quhaichuan</a><p class="description">学习笔记</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 主页</i></a><a href="/archives/"><i class="fa fa-archive"> 存档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">mysql</h1><div class="post-meta"><a href="/2020/02/18/mysql/#comments" class="comment-count"></a><p><span class="date">Feb 18, 2020</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><div class="toc">

<!-- toc -->

<ul>
<li><a href="#1-case-when-yong-fa">1.case..when用法</a><ul>
<li><a href="#1-1-shi-yong-ge-shi">1.1 使用格式</a></li>
<li><a href="#1-2-shi-yong-shi-li">1.2 使用实例</a><ul>
<li><a href="#1-2-1-gen-ju-cha-xun-jie-guo-zhi-chong-xin-ding-yi-zhi">1.2.1 根据查询结果值重新定义值</a></li>
<li><a href="#1-2-2-gen-ju-cha-xun-jie-guo-jin-xing-pan-duan-sou-suo">1.2.2 根据查询结果进行判断（搜索）</a></li>
<li><a href="#1-2-3-gao-ji-yong-fa-fen-zu-tong-ji">1.2.3 高级用法-分组统计</a></li>
<li><a href="#1-2-4-gao-ji-yong-fa-pi-liang-geng-xin">1.2.4 高级用法-批量更新</a></li>
<li><a href="#1-2-4-fu-he-tiao-jian-shi-yong">1.2.4 复合条件使用</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#2-mysql-zhong-de-ifnull-nullif-he-isnull-yong-fa-xiang-jie">2.MySql中的IFNULL、NULLIF和ISNULL用法详解</a><ul>
<li><a href="#2-1-isnull-yong-fa">2.1 isnull用法</a></li>
<li><a href="#2-2-ifnull-yong-fa">2.2 ifnull用法</a></li>
<li><a href="#2-3-nullif-yong-fa">2.3 nullif用法</a></li>
</ul>
</li>
<li><a href="#3-lian-jie-cha-xun">3.连结查询</a><ul>
<li><a href="#3-1-left-join-zuo-lian-jie-cha-xun">3.1 LEFT JOIN 左连结查询</a><ul>
<li><a href="#3-1-1-ji-ben-shi-yong-shi-li">3.1.1 基本使用示例</a></li>
<li><a href="#3-1-2-duo-biao-lian-jie-cha-xun">3.1.2 多表连结查询</a></li>
</ul>
</li>
<li><a href="#3-2-right-join-you-lian-jie-cha-xun">3.2 RIGHT JOIN 右连结查询</a><ul>
<li><a href="#3-2-1-ji-ben-shi-yong-shi-li">3.2.1 基本使用示例</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- tocstop -->

</div>

<h1><span id="1-case-when-yong-fa">1.case..when用法</span><a href="#1-case-when-yong-fa" class="header-anchor">#</a></h1><h2><span id="1-1-shi-yong-ge-shi">1.1 使用格式</span><a href="#1-1-shi-yong-ge-shi" class="header-anchor">#</a></h2><ul>
<li>简单函数<br>CASE [col_name] WHEN [value1] THEN [result1]…ELSE [default] END</li>
<li>搜索函数<br>CASE WHEN [expr] THEN [result1]…ELSE [default] END</li>
</ul>
<h2><span id="1-2-shi-yong-shi-li">1.2 使用实例</span><a href="#1-2-shi-yong-shi-li" class="header-anchor">#</a></h2><p><strong>预制数据</strong>-创建表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table person(</span><br><span class="line">    -&gt; id int(5) primary key,</span><br><span class="line">    -&gt; country varchar(20),</span><br><span class="line">    -&gt; name varchar(20),</span><br><span class="line">    -&gt; age int(3),</span><br><span class="line">    -&gt; gender varchar(2));</span><br><span class="line">Query OK, 0 rows affected (0.08 sec)</span><br></pre></td></tr></table></figure>

<p><strong>预制数据</strong>-插入数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO person(id, country, name, age, gender) VALUES(3,&#39;china&#39;,&#39;tom&#39;,12,&#39;1&#39;);</span><br><span class="line">INSERT INTO person(id, country, name, age, gender) VALUES(7,&#39;usa&#39;,&#39;kobe&#39;,10,&#39;1&#39;);</span><br><span class="line">INSERT INTO person(id, country, name, age, gender) VALUES(8,&#39;usa&#39;,&#39;james&#39;,20,&#39;1&#39;);</span><br><span class="line">INSERT INTO person(id, country, name, age, gender) VALUES(9,&#39;usa&#39;,&#39;grace&#39;,30,&#39;0&#39;);</span><br><span class="line">INSERT INTO person(id, country, name, age, gender) VALUES(10,&#39;japan&#39;,&#39;monica&#39;,40,&#39;2&#39;);</span><br></pre></td></tr></table></figure>

<p><strong>预制数据</strong>-完成表数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from person;</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">| id | country | name   | age  | gender |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">|  3 | china   | tom    |   12 | 1      |</span><br><span class="line">|  7 | usa     | kobe   |   10 | 1      |</span><br><span class="line">|  8 | usa     | james  |   20 | 1      |</span><br><span class="line">|  9 | usa     | grace  |   30 | 0      |</span><br><span class="line">| 10 | japan   | monica |   40 | 2      |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3><span id="1-2-1-gen-ju-cha-xun-jie-guo-zhi-chong-xin-ding-yi-zhi">1.2.1 根据查询结果值重新定义值</span><a href="#1-2-1-gen-ju-cha-xun-jie-guo-zhi-chong-xin-ding-yi-zhi" class="header-anchor">#</a></h3><p>从上面的表中，我们看到性别这一列其实可读性并不强，有时候为了数据库范式，会出现这种可读性不强的数据，那么我们在查询的时候可以使用CASE..WHEN重新使查询结果强可读。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT id,&#96;name&#96;,CASE gender WHEN 1 THEN &#39;男&#39; WHEN 0 THEN &#39;女&#39; ELSE &#39;其他&#39; END AS &#39;性别&#39; FRO</span><br><span class="line">M person;</span><br><span class="line">+----+--------+--------+</span><br><span class="line">| id | name   | 性别   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">|  3 | tom    | 男     |</span><br><span class="line">|  7 | kobe   | 男     |</span><br><span class="line">|  8 | james  | 男     |</span><br><span class="line">|  9 | grace  | 女     |</span><br><span class="line">| 10 | monica | 其他   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3><span id="1-2-2-gen-ju-cha-xun-jie-guo-jin-xing-pan-duan-sou-suo">1.2.2 根据查询结果进行判断（搜索）</span><a href="#1-2-2-gen-ju-cha-xun-jie-guo-jin-xing-pan-duan-sou-suo" class="header-anchor">#</a></h3><p>有时候我们需要在查询结果中对值进行简单逻辑处理，比如<br>小于18岁我们称少年<br>19-35称为青年<br>大于36称中年</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT id,&#96;name&#96;,CASE WHEN age&lt;18 THEN &#39;少年&#39;</span><br><span class="line">    -&gt; WHEN age&lt;&#x3D;35 THEN &#39;青年&#39;</span><br><span class="line">    -&gt; WHEN age&gt;36 THEN &#39;中年&#39;</span><br><span class="line">    -&gt; END &#39;状态&#39;</span><br><span class="line">    -&gt; FROM person;</span><br><span class="line">+----+--------+--------+</span><br><span class="line">| id | name   | 状态   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">|  3 | tom    | 少年   |</span><br><span class="line">|  7 | kobe   | 少年   |</span><br><span class="line">|  8 | james  | 青年   |</span><br><span class="line">|  9 | grace  | 青年   |</span><br><span class="line">| 10 | monica | 中年   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>总结</strong>：从上面的SQL可以看出，我们根据年龄列的值，凭空判断出了一列“状态”，这就是使用CASE进行判断(搜索)的例子<br><strong>注意</strong>：搜索函数可以写判断，并且搜索函数只会返回<strong>第一个</strong>符合条件的值，其他case被忽略</p>
<h3><span id="1-2-3-gao-ji-yong-fa-fen-zu-tong-ji">1.2.3 高级用法-分组统计</span><a href="#1-2-3-gao-ji-yong-fa-fen-zu-tong-ji" class="header-anchor">#</a></h3><p>在上面的person表中，我们要分别统计出每个国家的性别人数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT country,</span><br><span class="line">    -&gt; SUM(CASE WHEN gender&#x3D;1 THEN 1 ELSE 0 END) AS &#39;男&#39;,</span><br><span class="line">    -&gt; SUM(CASE WHEN gender&#x3D;0 THEN 1 ELSE 0 END) AS &#39;女&#39;,</span><br><span class="line">    -&gt; SUM(CASE WHEN gender&gt;1 THEN 1 ELSE 0 END) AS &#39;未知&#39;</span><br><span class="line">    -&gt; FROM person</span><br><span class="line">    -&gt; GROUP BY country;</span><br><span class="line">+---------+------+------+--------+</span><br><span class="line">| country | 男   | 女   | 未知   |</span><br><span class="line">+---------+------+------+--------+</span><br><span class="line">| china   |    1 |    0 |      0 |</span><br><span class="line">| japan   |    0 |    0 |      1 |</span><br><span class="line">| usa     |    2 |    1 |      0 |</span><br><span class="line">+---------+------+------+--------+</span><br><span class="line">3 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<h3><span id="1-2-4-gao-ji-yong-fa-pi-liang-geng-xin">1.2.4 高级用法-批量更新</span><a href="#1-2-4-gao-ji-yong-fa-pi-liang-geng-xin" class="header-anchor">#</a></h3><p>由于person表中的性别可读性不强，我们批量把性别字段更新成汉字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; UPDATE person SET gender&#x3D;CASE gender</span><br><span class="line">    -&gt; WHEN 1 THEN &#39;男&#39;</span><br><span class="line">    -&gt; WHEN 0 THEN &#39;女&#39;</span><br><span class="line">    -&gt; WHEN 2 THEN &#39;未知&#39;</span><br><span class="line">    -&gt; END</span><br><span class="line">    -&gt; WHERE gender IN (0,1,2);</span><br><span class="line">Query OK, 5 rows affected (0.01 sec)</span><br><span class="line">Rows matched: 5  Changed: 5  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM person;</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">| id | country | name   | age  | gender |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">|  3 | china   | tom    |   12 | 男     |</span><br><span class="line">|  7 | usa     | kobe   |   10 | 男     |</span><br><span class="line">|  8 | usa     | james  |   20 | 男     |</span><br><span class="line">|  9 | usa     | grace  |   30 | 女     |</span><br><span class="line">| 10 | japan   | monica |   40 | 未知   |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>注意事项：一定要有WHERE gender IN的限制，否则不在WHEN中的记录就会被置为NULL</strong><br>CASE..WHEN还有其他一些高级用法，等用到的时候再慢慢研究，比如可以用它做行转列操作。</p>
<h3><span id="1-2-4-fu-he-tiao-jian-shi-yong">1.2.4 复合条件使用</span><a href="#1-2-4-fu-he-tiao-jian-shi-yong" class="header-anchor">#</a></h3><p>比如上面定义青年的时候，我们把条件修改一下，我们把大于等于12岁，并且小于等于32岁的叫做青年</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM person;</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">| id | country | name   | age  | gender |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">|  3 | china   | tom    |   12 | 男     |</span><br><span class="line">|  7 | usa     | kobe   |   10 | 男     |</span><br><span class="line">|  8 | usa     | james  |   20 | 男     |</span><br><span class="line">|  9 | usa     | grace  |   30 | 女     |</span><br><span class="line">| 10 | japan   | monica |   40 | 未知   |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT id,&#96;name&#96;,CASE</span><br><span class="line">    -&gt; WHEN age&gt;&#x3D;12 AND age&lt;&#x3D;32 THEN &#39;青年&#39;</span><br><span class="line">    -&gt; ELSE &#39;忽略&#39;</span><br><span class="line">    -&gt; END &#39;状态&#39;</span><br><span class="line">    -&gt; FROM person;</span><br><span class="line">+----+--------+--------+</span><br><span class="line">| id | name   | 状态   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">|  3 | tom    | 青年   |</span><br><span class="line">|  7 | kobe   | 忽略   |</span><br><span class="line">|  8 | james  | 青年   |</span><br><span class="line">|  9 | grace  | 青年   |</span><br><span class="line">| 10 | monica | 忽略   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>总结</strong>:在WHEN条件使用时可以使用AND进行连接，进行复合条件的判断</p>
<blockquote>
<p><a href="https://www.jianshu.com/p/c2b086fb7b48" target="_blank" rel="noopener">参考博客</a><br><a href="https://www.cnblogs.com/chenduzizhong/p/9590741.html" target="_blank" rel="noopener">行转列参考博客</a><br><a href="https://blog.csdn.net/qb170217/article/details/81504578" target="_blank" rel="noopener">复合条件参考博客</a>  </p>
</blockquote>
<h1><span id="2-mysql-zhong-de-ifnull-nullif-he-isnull-yong-fa-xiang-jie">2.MySql中的IFNULL、NULLIF和ISNULL用法详解</span><a href="#2-mysql-zhong-de-ifnull-nullif-he-isnull-yong-fa-xiang-jie" class="header-anchor">#</a></h1><h2><span id="2-1-isnull-yong-fa">2.1 isnull用法</span><a href="#2-1-isnull-yong-fa" class="header-anchor">#</a></h2><p><strong>用法</strong>：isnull(expr)<br><strong>解析</strong>：如expr 为null，那么isnull() 的返回值为 1，否则返回值为 0。<br><strong>实例</strong>：这里还使用上面的person表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM person;</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">| id | country | name   | age  | gender |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">|  3 | china   | tom    |   12 | 男     |</span><br><span class="line">|  7 | usa     | kobe   |   10 | 男     |</span><br><span class="line">|  8 | usa     | james  |   20 | 男     |</span><br><span class="line">|  9 | usa     | grace  |   30 | 女     |</span><br><span class="line">| 10 | japan   | monica | NULL | 未知   |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT id,name,ISNULL(age) FROM person;</span><br><span class="line">+----+--------+-------------+</span><br><span class="line">| id | name   | ISNULL(age) |</span><br><span class="line">+----+--------+-------------+</span><br><span class="line">|  3 | tom    |           0 |</span><br><span class="line">|  7 | kobe   |           0 |</span><br><span class="line">|  8 | james  |           0 |</span><br><span class="line">|  9 | grace  |           0 |</span><br><span class="line">| 10 | monica |           1 |</span><br><span class="line">+----+--------+-------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2><span id="2-2-ifnull-yong-fa">2.2 ifnull用法</span><a href="#2-2-ifnull-yong-fa" class="header-anchor">#</a></h2><p><strong>用法</strong>:IFNULL(expr1,expr2)<br><strong>解析</strong>：假如expr1 不为 NULL，则 IFNULL() 的返回值为 expr1;<br>否则其返回值为 expr2。IFNULL()的返回值是数字或是字符串，具体情况取决于其所使用的语境。<br><strong>实例</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM person;</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">| id | country | name   | age  | gender |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">|  3 | china   | tom    |   12 | 男     |</span><br><span class="line">|  7 | usa     | kobe   |   10 | 男     |</span><br><span class="line">|  8 | usa     | james  |   20 | 男     |</span><br><span class="line">|  9 | usa     | grace  |   30 | 女     |</span><br><span class="line">| 10 | japan   | monica | NULL | 未知   |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT id,name,IFNULL(age,&#39;无&#39;) FROM person;</span><br><span class="line">+----+--------+-------------------+</span><br><span class="line">| id | name   | IFNULL(age,&#39;无&#39;)  |</span><br><span class="line">+----+--------+-------------------+</span><br><span class="line">|  3 | tom    | 12                |</span><br><span class="line">|  7 | kobe   | 10                |</span><br><span class="line">|  8 | james  | 20                |</span><br><span class="line">|  9 | grace  | 30                |</span><br><span class="line">| 10 | monica | 无                |</span><br><span class="line">+----+--------+-------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2><span id="2-3-nullif-yong-fa">2.3 nullif用法</span><a href="#2-3-nullif-yong-fa" class="header-anchor">#</a></h2><p><strong>用法</strong>：NULLIF(expr1,expr2)<br><strong>解析</strong>：如果expr1= expr2 成立，那么返回值为NULL，否则返回值为 expr1。这和CASE WHEN expr1 = expr2  THEN NULL ELSE expr1 END相同。<br><strong>实例</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT NULLIF(&#39;男&#39;,&#39;女&#39;);</span><br><span class="line">+---------------------+</span><br><span class="line">| NULLIF(&#39;男&#39;,&#39;女&#39;)   |</span><br><span class="line">+---------------------+</span><br><span class="line">| 男                  |</span><br><span class="line">+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT NULLIF(&#39;男&#39;,&#39;男&#39;);</span><br><span class="line">+---------------------+</span><br><span class="line">| NULLIF(&#39;男&#39;,&#39;男&#39;)   |</span><br><span class="line">+---------------------+</span><br><span class="line">| NULL                |</span><br><span class="line">+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">结果：当expr1和expr2不相等的时候，返回expr1，也就是‘男’，第二个例子相等的时候，返回的是NULL.</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://www.jb51.net/article/93101.htm" target="_blank" rel="noopener">nullif,isnull,ifnull参考博客</a>  </p>
</blockquote>
<h1><span id="3-lian-jie-cha-xun">3.连结查询</span><a href="#3-lian-jie-cha-xun" class="header-anchor">#</a></h1><p><strong>构造数据</strong>-创建表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">创建作者author表</span><br><span class="line">mysql&gt; CREATE TABLE author(</span><br><span class="line">    -&gt; author_id INT(2) PRIMARY KEY,</span><br><span class="line">    -&gt; name VARCHAR(20));</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">创建图书bookinfo表</span><br><span class="line">mysql&gt; CREATE TABLE bookinfo(</span><br><span class="line">    -&gt; id INT(2) PRIMARY KEY,</span><br><span class="line">    -&gt; name VARCHAR(10),</span><br><span class="line">    -&gt; publisher_id INT(2), #这里是指出版商的id</span><br><span class="line">    -&gt; author_id INT(2), #这里是指作者表的ID</span><br><span class="line">    -&gt; price INT(2));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">创建出版商publisher表</span><br><span class="line">mysql&gt; CREATE TABLE publisher(</span><br><span class="line">    -&gt; publisher_id INT(2) PRIMARY KEY,</span><br><span class="line">    -&gt; name VARCHAR(10));</span><br></pre></td></tr></table></figure>



<p><strong>构造数据</strong>-添加数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">插入author表数据</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (1, &#39;修昔底德&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (2, &#39;小仲马&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (3, &#39;柏拉图&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (4, &#39;亚里士多德&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (5, &#39;维吉尔&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (6, &#39;普鲁塔克&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (7, &#39;徐焰&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (8, &#39;老舍&#39;);</span><br><span class="line"></span><br><span class="line">插入bookinfo表数据</span><br><span class="line">对应字段顺序(&#96;id&#96;, &#96;name&#96;, &#96;publisher_id&#96;, &#96;author_id&#96;, &#96;price&#96;)</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (1, &#39;《伯罗奔尼撒战争史》&#39;, 1, 1, 11);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (2, &#39;《茶花女》&#39;, 2, 2, 22);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (3, &#39;《对话录》 &#39;, 3, 3, 22);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (4, &#39;《伦理学》&#39;, 4, 4, 44);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (5, &#39;《埃涅阿斯记》&#39;, 5, 5, 55);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (6, &#39;《希腊罗马英雄史》 &#39;, 6, 6, 66);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (7, &#39;《共产党人的故事》&#39;, 7, 7, 77);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (8, &#39;《四世同堂》&#39;, 8, 8, 88);</span><br><span class="line"></span><br><span class="line">插入publisher表数据</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (1, &#39;经济日报出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (2, &#39;外语教学与研究出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (3, &#39;中国纺织出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (4, &#39;编译出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (5, &#39;中国言实出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (6, &#39;东方出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (7, &#39;北京工艺美术出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (8, &#39;文津出版社&#39;);</span><br></pre></td></tr></table></figure>

<p><strong>构造数据</strong>-数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM author;</span><br><span class="line">+-----------+-----------------+</span><br><span class="line">| author_id | name            |</span><br><span class="line">+-----------+-----------------+</span><br><span class="line">|         1 | 修昔底德        |</span><br><span class="line">|         2 | 小仲马          |</span><br><span class="line">|         3 | 柏拉图          |</span><br><span class="line">|         4 | 亚里士多德      |</span><br><span class="line">|         5 | 维吉尔          |</span><br><span class="line">|         6 | 普鲁塔克        |</span><br><span class="line">|         7 | 徐焰            |</span><br><span class="line">|         8 | 老舍            |</span><br><span class="line">+-----------+-----------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM bookinfo;</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">| id | name                           | publisher_id | author_id | price |</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">|  1 | 《伯罗奔尼撒战争史》           |            1 |         1 |    11 |</span><br><span class="line">|  2 | 《茶花女》                     |            2 |         2 |    22 |</span><br><span class="line">|  3 | 《对话录》                     |            3 |         3 |    22 |</span><br><span class="line">|  4 | 《伦理学》                     |            4 |         4 |    44 |</span><br><span class="line">|  5 | 《埃涅阿斯记》                 |            5 |         5 |    55 |</span><br><span class="line">|  6 | 《希腊罗马英雄史》             |            6 |         6 |    66 |</span><br><span class="line">|  7 | 《共产党人的故事》             |            7 |         7 |    77 |</span><br><span class="line">|  8 | 《四世同堂》                   |            8 |         8 |    88 |</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM publisher;</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">| publisher_id | name                           |</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">|            1 | 经济日报出版社                 |</span><br><span class="line">|            2 | 外语教学与研究出版社           |</span><br><span class="line">|            3 | 中国纺织出版社                 |</span><br><span class="line">|            4 | 编译出版社                     |</span><br><span class="line">|            5 | 中国言实出版社                 |</span><br><span class="line">|            6 | 东方出版社                     |</span><br><span class="line">|            7 | 北京工艺美术出版社             |</span><br><span class="line">|            8 | 文津出版社                     |</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>





<h2><span id="3-1-left-join-zuo-lian-jie-cha-xun">3.1 LEFT JOIN 左连结查询</span><a href="#3-1-left-join-zuo-lian-jie-cha-xun" class="header-anchor">#</a></h2><p><strong>用法</strong>：SELECT XXX  FROM left_table <strong>LEFT JOIN</strong> right_table <strong>ON</strong> left_table.key=right_table.key</p>
<p><strong>解析</strong>：LEFT JOIN … ON   </p>
<p>LEFT JOIN 关键字会从左表 (left_table) 那里返回所有的行，即使在右表 (right_table ) 中没有匹配的行。</p>
<p>情况一：如果左表中的数据多，而右表中的数据少，那么没查询到的数据会显示NULL,但是左表的数据会全部返回；</p>
<p>情况二：如果左表中的数据少，而由表中的数据多（这里的多是指有重复数据，非重复数据见情况一），那么在返回左表数据时也会有重复；</p>
<h3><span id="3-1-1-ji-ben-shi-yong-shi-li">3.1.1 基本使用示例</span><a href="#3-1-1-ji-ben-shi-yong-shi-li" class="header-anchor">#</a></h3><p><strong>情况一</strong>：为了满足情况一，这里多添加一条出版商记录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (9, &#39;新华出版社&#39;);</span><br></pre></td></tr></table></figure>

<p>测试结果1：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (9, &#39;新华出版社&#39;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM publisher pub LEFT JOIN bookinfo book ON book.publisher_id&#x3D;pub.publisher_id;</span><br><span class="line">+-------+---------------------+----+--------------------+-------+---------+-----+</span><br><span class="line">| publis| name                |id  | name               |publi  |author_id|price|</span><br><span class="line">| her_id|                     |    |                    |sher_id|         |     |   </span><br><span class="line">+-------+---------------------+----+--------------------+-------+---------+-----+</span><br><span class="line">|  1    | 经济日报出版社        |   1|《伯罗奔尼撒战争史》    |    1  |        1|   11|</span><br><span class="line">|  2    | 外语教学与研究出版社   |   2| 《茶花女》           |    2  |        2|   22|</span><br><span class="line">|  3    | 中国纺织出版社        |   3| 《对话录》           |    3  |        3|   22|</span><br><span class="line">|  4    | 编译出版社           |   4| 《伦理学》           |    4  |        4|   44|</span><br><span class="line">|  5    | 中国言实出版社        |   5| 《埃涅阿斯记》        |    5  |        5|   55|</span><br><span class="line">|  6    | 东方出版社           |   6| 《希腊罗马英雄史》     |    6  |        6|   66|</span><br><span class="line">|  7    | 北京工艺美术出版社     |   7| 《共产党人的故事》     |    7  |        7|   77|</span><br><span class="line">|  8    | 文津出版社           |   8| 《四世同堂》           |    8  |        8|   88|</span><br><span class="line">|  9    | 新华出版社           |NULL| NULL                 | NULL  |     NULL| NULL|</span><br><span class="line">+-------+---------------------+----+--------------------+-------+---------+-----+</span><br></pre></td></tr></table></figure>

<p>可以看出，由于左表中有9条数据，而右表bookinfo中有8条数据，所以左表中的第9条数据，对应的bookinfo显示为NULL;</p>
<p><strong>情况一</strong>:右表有重复数据的情况</p>
<p>为了满足条件，需要插入一条重复bookinfo数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (9, &#39;《四世同堂》&#39;, 8, 8, 88);</span><br></pre></td></tr></table></figure>

<p>测试结果2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM publisher pub LEFT JOIN bookinfo book ON book.publisher_id&#x3D;pub.publisher_id;</span><br><span class="line">+-------------+---------+------+--------------+--------------+-----------+-------+</span><br><span class="line">|publisher_id | name    | id   | name         | publisher_id | author_id | price |</span><br><span class="line">+-------------+---------+------+--------------+--------------+-----------+-------+</span><br><span class="line">|  1 | 经济日报出版社     |1     | 《伯罗奔尼撒战争史》 |    1     |     1 |    11 |</span><br><span class="line">|  2 | 外语教学与研究出版社| 2    | 《茶花女》         |    2     |     2 |    22 |</span><br><span class="line">|  3 | 中国纺织出版社     | 3    | 《对话录》         |    3      |     3 |    22 |</span><br><span class="line">|  4 | 编译出版社        | 4    | 《伦理学》         |    4      |     4 |    44 |</span><br><span class="line">|  5 | 中国言实出版社     | 5    | 《埃涅阿斯记》      |    5     |     5 |    55 |</span><br><span class="line">|  6 | 东方出版社         | 6   | 《希腊罗马英雄史》   |    6     |     6 |    66 |</span><br><span class="line">|  7 | 北京工艺美术出版社 | 7    | 《共产党人的故事》   |    7      |     7 |    77 |</span><br><span class="line">|  8 | 文津出版社         | 8   | 《四世同堂》        |    8      |     8 |    88 |</span><br><span class="line">|  8 | 文津出版社         | 9   | 《四世同堂》        |    8      |     8 |    88 |</span><br><span class="line">|  9 | 新华出版社         | NULL | NULL             | NULL      |  NULL |  NULL |</span><br><span class="line">+-------------+----------+------+-----------------+------------+-----------+-------+</span><br></pre></td></tr></table></figure>

<p>从上面可以看出，在查询时，由于bookinfo表中有重复的两条，即根据ON条件，publisher_id有2个为8的，所以在返回结果中会出现两条重复的数据，要注意这个问题。</p>
<h3><span id="3-1-2-duo-biao-lian-jie-cha-xun">3.1.2 多表连结查询</span><a href="#3-1-2-duo-biao-lian-jie-cha-xun" class="header-anchor">#</a></h3><p>为了能够看出多表连结时ON的选用条件不一样，导致的查询结果也不一致的情况，在author表中添加一条数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (9, &#39;钱钟书&#39;);</span><br></pre></td></tr></table></figure>

<p>测试结果3：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM publisher pub LEFT JOIN bookinfo book ON book.publisher_id&#x3D;pub.publisher_id</span><br><span class="line">    -&gt; LEFT JOIN author auth ON auth.author_id&#x3D;book.author_id;</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">| publisher_id | name                           | id   | name                           | publisher_id | author_id | price | author_id | name            |</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">|            1 | 经济日报出版社                 |    1 | 《伯罗奔尼撒战争史》           |            1 |         1 |    11 |         1 | 修昔底德        |</span><br><span class="line">|            2 | 外语教学与研究出版社           |    2 | 《茶花女》                     |            2 |         2 |    22 |         2 | 小仲马          |</span><br><span class="line">|            3 | 中国纺织出版社                 |    3 | 《对话录》                     |            3 |         3 |    22 |         3 | 柏拉图          |</span><br><span class="line">|            4 | 编译出版社                     |    4 | 《伦理学》                     |            4 |         4 |    44 |         4 | 亚里士多德      |</span><br><span class="line">|            5 | 中国言实出版社                 |    5 | 《埃涅阿斯记》                 |            5 |         5 |    55 |         5 | 维吉尔          |</span><br><span class="line">|            6 | 东方出版社                     |    6 | 《希腊罗马英雄史》             |            6 |         6 |    66 |         6 | 普鲁塔克        |</span><br><span class="line">|            7 | 北京工艺美术出版社             |    7 | 《共产党人的故事》             |            7 |         7 |    77 |         7 | 徐焰            |</span><br><span class="line">|            8 | 文津出版社                     |    8 | 《四世同堂》                   |            8 |         8 |    88 |         8 | 老舍            |</span><br><span class="line">|            8 | 文津出版社                     |    9 | 《四世同堂》                   |            8 |         8 |    88 |         8 | 老舍            |</span><br><span class="line">|            9 | 新华出版社                     | NULL | NULL                           |         NULL |      NULL |  NULL |      NULL | NULL            |</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">10 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>上面示例的连结条件是：</p>
<p>以publisher为主表，LEFT JOIN首先连结bookinfo，连结条件book.publisher_id=pub.publisher_id，此时得到的一个表（假使有这个表，实际不会有这个步骤存在）</p>
<p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/9859ED717ACE4EA68F9608D605E974AA/13930" alt="image"></p>
<p>然后再用这个中间的大表作为主表，再LEFT JOIN author 表，ON auth.author_id=book.author_id，因为中间表此时是主表，再以这个表的book.author_id去查找，本身自己就是NULL,所以查找的结果还是NULL,见下图</p>
<p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/54C6D4F680A745918BAD054B4410DC01/13933" alt="最终左连结结果"></p>
<p>对应的模型如下：</p>
<p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/5EB39E524BBD41BA9F594B4EAC81D670/13935" alt="模型图"></p>
<p>测试结果4：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM publisher pub LEFT JOIN bookinfo book ON book.publisher_id&#x3D;pub.publisher_id</span><br><span class="line">    -&gt; LEFT JOIN author auth ON auth.author_id&#x3D;pub.publisher_id;</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">| publisher_id | name                           | id   | name                           | publisher_id | author_id | price | author_id | name            |</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">|            1 | 经济日报出版社                 |    1 | 《伯罗奔尼撒战争史》           |            1 |         1 |    11 |         1 | 修昔底德        |</span><br><span class="line">|            2 | 外语教学与研究出版社           |    2 | 《茶花女》                     |            2 |         2 |    22 |         2 | 小仲马          |</span><br><span class="line">|            3 | 中国纺织出版社                 |    3 | 《对话录》                     |            3 |         3 |    22 |         3 | 柏拉图          |</span><br><span class="line">|            4 | 编译出版社                     |    4 | 《伦理学》                     |            4 |         4 |    44 |         4 | 亚里士多德      |</span><br><span class="line">|            5 | 中国言实出版社                 |    5 | 《埃涅阿斯记》                 |            5 |         5 |    55 |         5 | 维吉尔          |</span><br><span class="line">|            6 | 东方出版社                     |    6 | 《希腊罗马英雄史》             |            6 |         6 |    66 |         6 | 普鲁塔克        |</span><br><span class="line">|            7 | 北京工艺美术出版社             |    7 | 《共产党人的故事》             |            7 |         7 |    77 |         7 | 徐焰            |</span><br><span class="line">|            8 | 文津出版社                     |    8 | 《四世同堂》                   |            8 |         8 |    88 |         8 | 老舍            |</span><br><span class="line">|            8 | 文津出版社                     |    9 | 《四世同堂》                   |            8 |         8 |    88 |         8 | 老舍            |</span><br><span class="line">|            9 | 新华出版社                     | NULL | NULL                           |         NULL |      NULL |  NULL |         9 | 钱钟书          |</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">10 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>上面示例的连结条件是：</p>
<p>以publisher为主表，LEFT JOIN首先连结bookinfo，连结条件book.publisher_id=pub.publisher_id，此时得到的一个表，如下</p>
<p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/9859ED717ACE4EA68F9608D605E974AA/13930" alt="image"></p>
<p>但是再第二次连结author的时候，继续以publisher表为主表，进行ON auth.author_id=pub.publisher_id，这时候得到的结果如下：</p>
<p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/E3AF61753F0E45249E70C02238B248B4/13938" alt="结果图片2"></p>
<p>注意此时连结后的author信息不为空了。</p>
<p>对应的连结模型如下：</p>
<p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/35D85B4E70464AF89699C7572B538B0B/13941" alt="模型2"></p>
<p><strong>总结</strong>：这说明在连结的时候，不同的表作为连结条件，获得的结果会不一样，同时主表的数据会全部展示，但是也可能会多，有可能连结表有重复数据，需要注意。</p>
<h2><span id="3-2-right-join-you-lian-jie-cha-xun">3.2 RIGHT JOIN 右连结查询</span><a href="#3-2-right-join-you-lian-jie-cha-xun" class="header-anchor">#</a></h2><p><strong>用法</strong>：SELECT XXX  FROM left_table  <strong>RIGHT JOIN</strong> main_table <strong>ON</strong> left_table.key=main_table.key</p>
<p><strong>解析</strong>：RIGHT JOIN … ON   </p>
<p>RIGHT JOIN 关键字会右表 (main_table) 那里返回所有的行，即使在左表 ( left_table) 中没有匹配的行。</p>
<p><strong>注意</strong>：在LEFT JOIN中，左边的表为主表，但是在RIGHT JOIN中，RIGHT JOIN哪个表，哪个表就作为主表，会返回所有的行</p>
<h3><span id="3-2-1-ji-ben-shi-yong-shi-li">3.2.1 基本使用示例</span><a href="#3-2-1-ji-ben-shi-yong-shi-li" class="header-anchor">#</a></h3><p>这个操作还是在上面表的基础上进行的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM publisher;</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">| publisher_id | name                           |</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">|            1 | 经济日报出版社                 |</span><br><span class="line">|            2 | 外语教学与研究出版社           |</span><br><span class="line">|            3 | 中国纺织出版社                 |</span><br><span class="line">|            4 | 编译出版社                     |</span><br><span class="line">|            5 | 中国言实出版社                 |</span><br><span class="line">|            6 | 东方出版社                     |</span><br><span class="line">|            7 | 北京工艺美术出版社             |</span><br><span class="line">|            8 | 文津出版社                     |</span><br><span class="line">|            9 | 新华出版社                     |</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM bookinfo;</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">| id | name                           | publisher_id | author_id | price |</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">|  1 | 《伯罗奔尼撒战争史》           |            1 |         1 |    11 |</span><br><span class="line">|  2 | 《茶花女》                     |            2 |         2 |    22 |</span><br><span class="line">|  3 | 《对话录》                     |            3 |         3 |    22 |</span><br><span class="line">|  4 | 《伦理学》                     |            4 |         4 |    44 |</span><br><span class="line">|  5 | 《埃涅阿斯记》                 |            5 |         5 |    55 |</span><br><span class="line">|  6 | 《希腊罗马英雄史》             |            6 |         6 |    66 |</span><br><span class="line">|  7 | 《共产党人的故事》             |            7 |         7 |    77 |</span><br><span class="line">|  8 | 《四世同堂》                   |            8 |         8 |    88 |</span><br><span class="line">|  9 | 《四世同堂》                   |            8 |         8 |    88 |</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>示例使用的SQL如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM bookinfo book RIGHT JOIN publisher pub ON book.publisher_id&#x3D;pub.publisher_id;</span><br></pre></td></tr></table></figure>

<p>查询结果如下：</p>
<p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/A98AB8B45D04473BBB11B36E9224F4E5/13943" alt="查询结果2"></p>
<p><strong>总结</strong>：RIGHT JOIN查询的时候用被连结的表publisher作为主表，返回所有数据，RIGHT JOIN左边的就是从表，如果没有匹配到的就展示为NULL.</p>
<p><strong>其他</strong>：RIGHT JOIN的多表查询情况跟LEFT JOIN类似，这里不再赘述</p>
<blockquote>
<p><a href="https://www.w3school.com.cn/sql/sql_join_right.asp" target="_blank" rel="noopener">参考博客</a>  </p>
<p><a href="https://blog.csdn.net/lp_cq242/article/details/79942457" target="_blank" rel="noopener">参考博客</a>  </p>
<p><a href="https://www.cnblogs.com/bad-robot/p/9788959.html" target="_blank" rel="noopener">参考博客</a></p>
</blockquote>
</div><div class="post-copyright"><blockquote><p>原文作者: 屈海川</p><p>原文链接: <a href="https://babachuan.github.io/2020/02/18/mysql/">https://babachuan.github.io/2020/02/18/mysql/</a></p><p>版权声明: 转载请注明出处(必须保留作者署名及链接)</p></blockquote></div><div class="tags"><a href="/tags/MySQL/">MySQL</a></div><div class="post-share"><div class="social-share"><span>分享到:</span></div></div><div class="post-nav"><a href="/2020/02/22/spring/" class="pre">Spring</a><a href="/2020/02/16/%E6%B5%8B%E8%AF%95%E7%90%86%E8%AE%BA/" class="next">测试理论</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">1.case..when用法#</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">1.1 使用格式#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">1.2 使用实例#</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">1.2.1 根据查询结果值重新定义值#</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">1.2.2 根据查询结果进行判断（搜索）#</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">1.2.3 高级用法-分组统计#</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">1.2.4 高级用法-批量更新#</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">1.2.4 复合条件使用#</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">2.MySql中的IFNULL、NULLIF和ISNULL用法详解#</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">2.1 isnull用法#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">2.2 ifnull用法#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">2.3 nullif用法#</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">3.连结查询#</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">3.1 LEFT JOIN 左连结查询#</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">3.1.1 基本使用示例#</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">3.1.2 多表连结查询#</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">3.2 RIGHT JOIN 右连结查询#</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">3.2.1 基本使用示例#</span></a></li></ol></li></ol></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/03/09/springboot/">springboot</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/04/IDEA%E5%B7%A5%E5%85%B7/">IDEA工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/25/Docker/">Docker</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/25/Linux/">Linux</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/22/spring/">Spring</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/18/mysql/">mysql</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/16/%E6%B5%8B%E8%AF%95%E7%90%86%E8%AE%BA/">测试理论</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/16/github/">git</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/16/FastDFS/">FastDFS</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/16/activeMQ/">activeMQ</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Python%E5%BA%93/">Python库</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/tags/IDEA/" style="font-size: 15px;">IDEA</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/SpringBoot/" style="font-size: 15px;">SpringBoot</a> <a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 15px;">测试</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">15</span></li></ul></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |  <a href="/atom.xml">订阅本站</a> |  <a href="/about/">联系博主</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">屈海川.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/" target="_blank" rel="noopener"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.5"></script><div id="fullscreen-img" class="hide"><span class="close"></span></div><script type="text/javascript" src="/js/imgview.js?v=2.0.5" async></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.5" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script></body></html>