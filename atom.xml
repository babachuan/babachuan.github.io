<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>quhaichuan</title>
  
  <subtitle>学习笔记</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-02-19T07:54:44.949Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>屈海川</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>mysql</title>
    <link href="http://yoursite.com/2020/02/18/mysql/"/>
    <id>http://yoursite.com/2020/02/18/mysql/</id>
    <published>2020-02-18T04:49:01.000Z</published>
    <updated>2020-02-19T07:54:44.949Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><!-- toc --><ul><li><a href="#1-case-when-yong-fa">1.case..when用法</a><ul><li><a href="#1-1-shi-yong-ge-shi">1.1 使用格式</a></li><li><a href="#1-2-shi-yong-shi-li">1.2 使用实例</a><ul><li><a href="#1-2-1-gen-ju-cha-xun-jie-guo-zhi-chong-xin-ding-yi-zhi">1.2.1 根据查询结果值重新定义值</a></li><li><a href="#1-2-2-gen-ju-cha-xun-jie-guo-jin-xing-pan-duan-sou-suo">1.2.2 根据查询结果进行判断（搜索）</a></li><li><a href="#1-2-3-gao-ji-yong-fa-fen-zu-tong-ji">1.2.3 高级用法-分组统计</a></li><li><a href="#1-2-4-gao-ji-yong-fa-pi-liang-geng-xin">1.2.4 高级用法-批量更新</a></li><li><a href="#1-2-4-fu-he-tiao-jian-shi-yong">1.2.4 复合条件使用</a></li></ul></li></ul></li><li><a href="#2-mysql-zhong-de-ifnull-nullif-he-isnull-yong-fa-xiang-jie">2.MySql中的IFNULL、NULLIF和ISNULL用法详解</a><ul><li><a href="#2-1-isnull-yong-fa">2.1 isnull用法</a></li><li><a href="#2-2-ifnull-yong-fa">2.2 ifnull用法</a></li><li><a href="#2-3-nullif-yong-fa">2.3 nullif用法</a></li></ul></li><li><a href="#3-lian-jie-cha-xun">3.连结查询</a><ul><li><a href="#3-1-left-join-zuo-lian-jie-cha-xun">3.1 LEFT JOIN 左连结查询</a><ul><li><a href="#3-1-1-ji-ben-shi-yong-shi-li">3.1.1 基本使用示例</a></li><li><a href="#3-1-2-duo-biao-lian-jie-cha-xun">3.1.2 多表连结查询</a></li></ul></li><li><a href="#3-2-right-join-you-lian-jie-cha-xun">3.2 RIGHT JOIN 右连结查询</a><ul><li><a href="#3-2-1-ji-ben-shi-yong-shi-li">3.2.1 基本使用示例</a></li></ul></li></ul></li></ul><!-- tocstop --></div><h1><span id="1-case-when-yong-fa">1.case..when用法</span><a href="#1-case-when-yong-fa" class="header-anchor">#</a></h1><h2><span id="1-1-shi-yong-ge-shi">1.1 使用格式</span><a href="#1-1-shi-yong-ge-shi" class="header-anchor">#</a></h2><ul><li>简单函数<br>CASE [col_name] WHEN [value1] THEN [result1]…ELSE [default] END</li><li>搜索函数<br>CASE WHEN [expr] THEN [result1]…ELSE [default] END</li></ul><h2><span id="1-2-shi-yong-shi-li">1.2 使用实例</span><a href="#1-2-shi-yong-shi-li" class="header-anchor">#</a></h2><p><strong>预制数据</strong>-创建表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table person(</span><br><span class="line">    -&gt; id int(5) primary key,</span><br><span class="line">    -&gt; country varchar(20),</span><br><span class="line">    -&gt; name varchar(20),</span><br><span class="line">    -&gt; age int(3),</span><br><span class="line">    -&gt; gender varchar(2));</span><br><span class="line">Query OK, 0 rows affected (0.08 sec)</span><br></pre></td></tr></table></figure><p><strong>预制数据</strong>-插入数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO person(id, country, name, age, gender) VALUES(3,&#39;china&#39;,&#39;tom&#39;,12,&#39;1&#39;);</span><br><span class="line">INSERT INTO person(id, country, name, age, gender) VALUES(7,&#39;usa&#39;,&#39;kobe&#39;,10,&#39;1&#39;);</span><br><span class="line">INSERT INTO person(id, country, name, age, gender) VALUES(8,&#39;usa&#39;,&#39;james&#39;,20,&#39;1&#39;);</span><br><span class="line">INSERT INTO person(id, country, name, age, gender) VALUES(9,&#39;usa&#39;,&#39;grace&#39;,30,&#39;0&#39;);</span><br><span class="line">INSERT INTO person(id, country, name, age, gender) VALUES(10,&#39;japan&#39;,&#39;monica&#39;,40,&#39;2&#39;);</span><br></pre></td></tr></table></figure><p><strong>预制数据</strong>-完成表数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from person;</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">| id | country | name   | age  | gender |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">|  3 | china   | tom    |   12 | 1      |</span><br><span class="line">|  7 | usa     | kobe   |   10 | 1      |</span><br><span class="line">|  8 | usa     | james  |   20 | 1      |</span><br><span class="line">|  9 | usa     | grace  |   30 | 0      |</span><br><span class="line">| 10 | japan   | monica |   40 | 2      |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h3><span id="1-2-1-gen-ju-cha-xun-jie-guo-zhi-chong-xin-ding-yi-zhi">1.2.1 根据查询结果值重新定义值</span><a href="#1-2-1-gen-ju-cha-xun-jie-guo-zhi-chong-xin-ding-yi-zhi" class="header-anchor">#</a></h3><p>从上面的表中，我们看到性别这一列其实可读性并不强，有时候为了数据库范式，会出现这种可读性不强的数据，那么我们在查询的时候可以使用CASE..WHEN重新使查询结果强可读。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT id,&#96;name&#96;,CASE gender WHEN 1 THEN &#39;男&#39; WHEN 0 THEN &#39;女&#39; ELSE &#39;其他&#39; END AS &#39;性别&#39; FRO</span><br><span class="line">M person;</span><br><span class="line">+----+--------+--------+</span><br><span class="line">| id | name   | 性别   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">|  3 | tom    | 男     |</span><br><span class="line">|  7 | kobe   | 男     |</span><br><span class="line">|  8 | james  | 男     |</span><br><span class="line">|  9 | grace  | 女     |</span><br><span class="line">| 10 | monica | 其他   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h3><span id="1-2-2-gen-ju-cha-xun-jie-guo-jin-xing-pan-duan-sou-suo">1.2.2 根据查询结果进行判断（搜索）</span><a href="#1-2-2-gen-ju-cha-xun-jie-guo-jin-xing-pan-duan-sou-suo" class="header-anchor">#</a></h3><p>有时候我们需要在查询结果中对值进行简单逻辑处理，比如<br>小于18岁我们称少年<br>19-35称为青年<br>大于36称中年</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT id,&#96;name&#96;,CASE WHEN age&lt;18 THEN &#39;少年&#39;</span><br><span class="line">    -&gt; WHEN age&lt;&#x3D;35 THEN &#39;青年&#39;</span><br><span class="line">    -&gt; WHEN age&gt;36 THEN &#39;中年&#39;</span><br><span class="line">    -&gt; END &#39;状态&#39;</span><br><span class="line">    -&gt; FROM person;</span><br><span class="line">+----+--------+--------+</span><br><span class="line">| id | name   | 状态   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">|  3 | tom    | 少年   |</span><br><span class="line">|  7 | kobe   | 少年   |</span><br><span class="line">|  8 | james  | 青年   |</span><br><span class="line">|  9 | grace  | 青年   |</span><br><span class="line">| 10 | monica | 中年   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>总结</strong>：从上面的SQL可以看出，我们根据年龄列的值，凭空判断出了一列“状态”，这就是使用CASE进行判断(搜索)的例子<br><strong>注意</strong>：搜索函数可以写判断，并且搜索函数只会返回<strong>第一个</strong>符合条件的值，其他case被忽略</p><h3><span id="1-2-3-gao-ji-yong-fa-fen-zu-tong-ji">1.2.3 高级用法-分组统计</span><a href="#1-2-3-gao-ji-yong-fa-fen-zu-tong-ji" class="header-anchor">#</a></h3><p>在上面的person表中，我们要分别统计出每个国家的性别人数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT country,</span><br><span class="line">    -&gt; SUM(CASE WHEN gender&#x3D;1 THEN 1 ELSE 0 END) AS &#39;男&#39;,</span><br><span class="line">    -&gt; SUM(CASE WHEN gender&#x3D;0 THEN 1 ELSE 0 END) AS &#39;女&#39;,</span><br><span class="line">    -&gt; SUM(CASE WHEN gender&gt;1 THEN 1 ELSE 0 END) AS &#39;未知&#39;</span><br><span class="line">    -&gt; FROM person</span><br><span class="line">    -&gt; GROUP BY country;</span><br><span class="line">+---------+------+------+--------+</span><br><span class="line">| country | 男   | 女   | 未知   |</span><br><span class="line">+---------+------+------+--------+</span><br><span class="line">| china   |    1 |    0 |      0 |</span><br><span class="line">| japan   |    0 |    0 |      1 |</span><br><span class="line">| usa     |    2 |    1 |      0 |</span><br><span class="line">+---------+------+------+--------+</span><br><span class="line">3 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure><h3><span id="1-2-4-gao-ji-yong-fa-pi-liang-geng-xin">1.2.4 高级用法-批量更新</span><a href="#1-2-4-gao-ji-yong-fa-pi-liang-geng-xin" class="header-anchor">#</a></h3><p>由于person表中的性别可读性不强，我们批量把性别字段更新成汉字</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; UPDATE person SET gender&#x3D;CASE gender</span><br><span class="line">    -&gt; WHEN 1 THEN &#39;男&#39;</span><br><span class="line">    -&gt; WHEN 0 THEN &#39;女&#39;</span><br><span class="line">    -&gt; WHEN 2 THEN &#39;未知&#39;</span><br><span class="line">    -&gt; END</span><br><span class="line">    -&gt; WHERE gender IN (0,1,2);</span><br><span class="line">Query OK, 5 rows affected (0.01 sec)</span><br><span class="line">Rows matched: 5  Changed: 5  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM person;</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">| id | country | name   | age  | gender |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">|  3 | china   | tom    |   12 | 男     |</span><br><span class="line">|  7 | usa     | kobe   |   10 | 男     |</span><br><span class="line">|  8 | usa     | james  |   20 | 男     |</span><br><span class="line">|  9 | usa     | grace  |   30 | 女     |</span><br><span class="line">| 10 | japan   | monica |   40 | 未知   |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>注意事项：一定要有WHERE gender IN的限制，否则不在WHEN中的记录就会被置为NULL</strong><br>CASE..WHEN还有其他一些高级用法，等用到的时候再慢慢研究，比如可以用它做行转列操作。</p><h3><span id="1-2-4-fu-he-tiao-jian-shi-yong">1.2.4 复合条件使用</span><a href="#1-2-4-fu-he-tiao-jian-shi-yong" class="header-anchor">#</a></h3><p>比如上面定义青年的时候，我们把条件修改一下，我们把大于等于12岁，并且小于等于32岁的叫做青年</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM person;</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">| id | country | name   | age  | gender |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">|  3 | china   | tom    |   12 | 男     |</span><br><span class="line">|  7 | usa     | kobe   |   10 | 男     |</span><br><span class="line">|  8 | usa     | james  |   20 | 男     |</span><br><span class="line">|  9 | usa     | grace  |   30 | 女     |</span><br><span class="line">| 10 | japan   | monica |   40 | 未知   |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT id,&#96;name&#96;,CASE</span><br><span class="line">    -&gt; WHEN age&gt;&#x3D;12 AND age&lt;&#x3D;32 THEN &#39;青年&#39;</span><br><span class="line">    -&gt; ELSE &#39;忽略&#39;</span><br><span class="line">    -&gt; END &#39;状态&#39;</span><br><span class="line">    -&gt; FROM person;</span><br><span class="line">+----+--------+--------+</span><br><span class="line">| id | name   | 状态   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">|  3 | tom    | 青年   |</span><br><span class="line">|  7 | kobe   | 忽略   |</span><br><span class="line">|  8 | james  | 青年   |</span><br><span class="line">|  9 | grace  | 青年   |</span><br><span class="line">| 10 | monica | 忽略   |</span><br><span class="line">+----+--------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>总结</strong>:在WHEN条件使用时可以使用AND进行连接，进行复合条件的判断</p><blockquote><p><a href="https://www.jianshu.com/p/c2b086fb7b48" target="_blank" rel="noopener">参考博客</a><br><a href="https://www.cnblogs.com/chenduzizhong/p/9590741.html" target="_blank" rel="noopener">行转列参考博客</a><br><a href="https://blog.csdn.net/qb170217/article/details/81504578" target="_blank" rel="noopener">复合条件参考博客</a>  </p></blockquote><h1><span id="2-mysql-zhong-de-ifnull-nullif-he-isnull-yong-fa-xiang-jie">2.MySql中的IFNULL、NULLIF和ISNULL用法详解</span><a href="#2-mysql-zhong-de-ifnull-nullif-he-isnull-yong-fa-xiang-jie" class="header-anchor">#</a></h1><h2><span id="2-1-isnull-yong-fa">2.1 isnull用法</span><a href="#2-1-isnull-yong-fa" class="header-anchor">#</a></h2><p><strong>用法</strong>：isnull(expr)<br><strong>解析</strong>：如expr 为null，那么isnull() 的返回值为 1，否则返回值为 0。<br><strong>实例</strong>：这里还使用上面的person表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM person;</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">| id | country | name   | age  | gender |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">|  3 | china   | tom    |   12 | 男     |</span><br><span class="line">|  7 | usa     | kobe   |   10 | 男     |</span><br><span class="line">|  8 | usa     | james  |   20 | 男     |</span><br><span class="line">|  9 | usa     | grace  |   30 | 女     |</span><br><span class="line">| 10 | japan   | monica | NULL | 未知   |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT id,name,ISNULL(age) FROM person;</span><br><span class="line">+----+--------+-------------+</span><br><span class="line">| id | name   | ISNULL(age) |</span><br><span class="line">+----+--------+-------------+</span><br><span class="line">|  3 | tom    |           0 |</span><br><span class="line">|  7 | kobe   |           0 |</span><br><span class="line">|  8 | james  |           0 |</span><br><span class="line">|  9 | grace  |           0 |</span><br><span class="line">| 10 | monica |           1 |</span><br><span class="line">+----+--------+-------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2><span id="2-2-ifnull-yong-fa">2.2 ifnull用法</span><a href="#2-2-ifnull-yong-fa" class="header-anchor">#</a></h2><p><strong>用法</strong>:IFNULL(expr1,expr2)<br><strong>解析</strong>：假如expr1 不为 NULL，则 IFNULL() 的返回值为 expr1;<br>否则其返回值为 expr2。IFNULL()的返回值是数字或是字符串，具体情况取决于其所使用的语境。<br><strong>实例</strong>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM person;</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">| id | country | name   | age  | gender |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">|  3 | china   | tom    |   12 | 男     |</span><br><span class="line">|  7 | usa     | kobe   |   10 | 男     |</span><br><span class="line">|  8 | usa     | james  |   20 | 男     |</span><br><span class="line">|  9 | usa     | grace  |   30 | 女     |</span><br><span class="line">| 10 | japan   | monica | NULL | 未知   |</span><br><span class="line">+----+---------+--------+------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT id,name,IFNULL(age,&#39;无&#39;) FROM person;</span><br><span class="line">+----+--------+-------------------+</span><br><span class="line">| id | name   | IFNULL(age,&#39;无&#39;)  |</span><br><span class="line">+----+--------+-------------------+</span><br><span class="line">|  3 | tom    | 12                |</span><br><span class="line">|  7 | kobe   | 10                |</span><br><span class="line">|  8 | james  | 20                |</span><br><span class="line">|  9 | grace  | 30                |</span><br><span class="line">| 10 | monica | 无                |</span><br><span class="line">+----+--------+-------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2><span id="2-3-nullif-yong-fa">2.3 nullif用法</span><a href="#2-3-nullif-yong-fa" class="header-anchor">#</a></h2><p><strong>用法</strong>：NULLIF(expr1,expr2)<br><strong>解析</strong>：如果expr1= expr2 成立，那么返回值为NULL，否则返回值为 expr1。这和CASE WHEN expr1 = expr2  THEN NULL ELSE expr1 END相同。<br><strong>实例</strong>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT NULLIF(&#39;男&#39;,&#39;女&#39;);</span><br><span class="line">+---------------------+</span><br><span class="line">| NULLIF(&#39;男&#39;,&#39;女&#39;)   |</span><br><span class="line">+---------------------+</span><br><span class="line">| 男                  |</span><br><span class="line">+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT NULLIF(&#39;男&#39;,&#39;男&#39;);</span><br><span class="line">+---------------------+</span><br><span class="line">| NULLIF(&#39;男&#39;,&#39;男&#39;)   |</span><br><span class="line">+---------------------+</span><br><span class="line">| NULL                |</span><br><span class="line">+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">结果：当expr1和expr2不相等的时候，返回expr1，也就是‘男’，第二个例子相等的时候，返回的是NULL.</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://www.jb51.net/article/93101.htm" target="_blank" rel="noopener">nullif,isnull,ifnull参考博客</a>  </p></blockquote><h1><span id="3-lian-jie-cha-xun">3.连结查询</span><a href="#3-lian-jie-cha-xun" class="header-anchor">#</a></h1><p><strong>构造数据</strong>-创建表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">创建作者author表</span><br><span class="line">mysql&gt; CREATE TABLE author(</span><br><span class="line">    -&gt; author_id INT(2) PRIMARY KEY,</span><br><span class="line">    -&gt; name VARCHAR(20));</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">创建图书bookinfo表</span><br><span class="line">mysql&gt; CREATE TABLE bookinfo(</span><br><span class="line">    -&gt; id INT(2) PRIMARY KEY,</span><br><span class="line">    -&gt; name VARCHAR(10),</span><br><span class="line">    -&gt; publisher_id INT(2), #这里是指出版商的id</span><br><span class="line">    -&gt; author_id INT(2), #这里是指作者表的ID</span><br><span class="line">    -&gt; price INT(2));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">创建出版商publisher表</span><br><span class="line">mysql&gt; CREATE TABLE publisher(</span><br><span class="line">    -&gt; publisher_id INT(2) PRIMARY KEY,</span><br><span class="line">    -&gt; name VARCHAR(10));</span><br></pre></td></tr></table></figure><p><strong>构造数据</strong>-添加数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">插入author表数据</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (1, &#39;修昔底德&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (2, &#39;小仲马&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (3, &#39;柏拉图&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (4, &#39;亚里士多德&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (5, &#39;维吉尔&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (6, &#39;普鲁塔克&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (7, &#39;徐焰&#39;);</span><br><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (8, &#39;老舍&#39;);</span><br><span class="line"></span><br><span class="line">插入bookinfo表数据</span><br><span class="line">对应字段顺序(&#96;id&#96;, &#96;name&#96;, &#96;publisher_id&#96;, &#96;author_id&#96;, &#96;price&#96;)</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (1, &#39;《伯罗奔尼撒战争史》&#39;, 1, 1, 11);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (2, &#39;《茶花女》&#39;, 2, 2, 22);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (3, &#39;《对话录》 &#39;, 3, 3, 22);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (4, &#39;《伦理学》&#39;, 4, 4, 44);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (5, &#39;《埃涅阿斯记》&#39;, 5, 5, 55);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (6, &#39;《希腊罗马英雄史》 &#39;, 6, 6, 66);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (7, &#39;《共产党人的故事》&#39;, 7, 7, 77);</span><br><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (8, &#39;《四世同堂》&#39;, 8, 8, 88);</span><br><span class="line"></span><br><span class="line">插入publisher表数据</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (1, &#39;经济日报出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (2, &#39;外语教学与研究出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (3, &#39;中国纺织出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (4, &#39;编译出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (5, &#39;中国言实出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (6, &#39;东方出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (7, &#39;北京工艺美术出版社&#39;);</span><br><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (8, &#39;文津出版社&#39;);</span><br></pre></td></tr></table></figure><p><strong>构造数据</strong>-数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM author;</span><br><span class="line">+-----------+-----------------+</span><br><span class="line">| author_id | name            |</span><br><span class="line">+-----------+-----------------+</span><br><span class="line">|         1 | 修昔底德        |</span><br><span class="line">|         2 | 小仲马          |</span><br><span class="line">|         3 | 柏拉图          |</span><br><span class="line">|         4 | 亚里士多德      |</span><br><span class="line">|         5 | 维吉尔          |</span><br><span class="line">|         6 | 普鲁塔克        |</span><br><span class="line">|         7 | 徐焰            |</span><br><span class="line">|         8 | 老舍            |</span><br><span class="line">+-----------+-----------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM bookinfo;</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">| id | name                           | publisher_id | author_id | price |</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">|  1 | 《伯罗奔尼撒战争史》           |            1 |         1 |    11 |</span><br><span class="line">|  2 | 《茶花女》                     |            2 |         2 |    22 |</span><br><span class="line">|  3 | 《对话录》                     |            3 |         3 |    22 |</span><br><span class="line">|  4 | 《伦理学》                     |            4 |         4 |    44 |</span><br><span class="line">|  5 | 《埃涅阿斯记》                 |            5 |         5 |    55 |</span><br><span class="line">|  6 | 《希腊罗马英雄史》             |            6 |         6 |    66 |</span><br><span class="line">|  7 | 《共产党人的故事》             |            7 |         7 |    77 |</span><br><span class="line">|  8 | 《四世同堂》                   |            8 |         8 |    88 |</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM publisher;</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">| publisher_id | name                           |</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">|            1 | 经济日报出版社                 |</span><br><span class="line">|            2 | 外语教学与研究出版社           |</span><br><span class="line">|            3 | 中国纺织出版社                 |</span><br><span class="line">|            4 | 编译出版社                     |</span><br><span class="line">|            5 | 中国言实出版社                 |</span><br><span class="line">|            6 | 东方出版社                     |</span><br><span class="line">|            7 | 北京工艺美术出版社             |</span><br><span class="line">|            8 | 文津出版社                     |</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2><span id="3-1-left-join-zuo-lian-jie-cha-xun">3.1 LEFT JOIN 左连结查询</span><a href="#3-1-left-join-zuo-lian-jie-cha-xun" class="header-anchor">#</a></h2><p><strong>用法</strong>：SELECT XXX  FROM left_table <strong>LEFT JOIN</strong> right_table <strong>ON</strong> left_table.key=right_table.key</p><p><strong>解析</strong>：LEFT JOIN … ON   </p><p>LEFT JOIN 关键字会从左表 (left_table) 那里返回所有的行，即使在右表 (right_table ) 中没有匹配的行。</p><p>情况一：如果左表中的数据多，而右表中的数据少，那么没查询到的数据会显示NULL,但是左表的数据会全部返回；</p><p>情况二：如果左表中的数据少，而由表中的数据多（这里的多是指有重复数据，非重复数据见情况一），那么在返回左表数据时也会有重复；</p><h3><span id="3-1-1-ji-ben-shi-yong-shi-li">3.1.1 基本使用示例</span><a href="#3-1-1-ji-ben-shi-yong-shi-li" class="header-anchor">#</a></h3><p><strong>情况一</strong>：为了满足情况一，这里多添加一条出版商记录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (9, &#39;新华出版社&#39;);</span><br></pre></td></tr></table></figure><p>测试结果1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; INSERT INTO &#96;publisher&#96;(&#96;publisher_id&#96;, &#96;name&#96;) VALUES (9, &#39;新华出版社&#39;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM publisher pub LEFT JOIN bookinfo book ON book.publisher_id&#x3D;pub.publisher_id;</span><br><span class="line">+-------+---------------------+----+--------------------+-------+---------+-----+</span><br><span class="line">| publis| name                |id  | name               |publi  |author_id|price|</span><br><span class="line">| her_id|                     |    |                    |sher_id|         |     |   </span><br><span class="line">+-------+---------------------+----+--------------------+-------+---------+-----+</span><br><span class="line">|  1    | 经济日报出版社        |   1|《伯罗奔尼撒战争史》    |    1  |        1|   11|</span><br><span class="line">|  2    | 外语教学与研究出版社   |   2| 《茶花女》           |    2  |        2|   22|</span><br><span class="line">|  3    | 中国纺织出版社        |   3| 《对话录》           |    3  |        3|   22|</span><br><span class="line">|  4    | 编译出版社           |   4| 《伦理学》           |    4  |        4|   44|</span><br><span class="line">|  5    | 中国言实出版社        |   5| 《埃涅阿斯记》        |    5  |        5|   55|</span><br><span class="line">|  6    | 东方出版社           |   6| 《希腊罗马英雄史》     |    6  |        6|   66|</span><br><span class="line">|  7    | 北京工艺美术出版社     |   7| 《共产党人的故事》     |    7  |        7|   77|</span><br><span class="line">|  8    | 文津出版社           |   8| 《四世同堂》           |    8  |        8|   88|</span><br><span class="line">|  9    | 新华出版社           |NULL| NULL                 | NULL  |     NULL| NULL|</span><br><span class="line">+-------+---------------------+----+--------------------+-------+---------+-----+</span><br></pre></td></tr></table></figure><p>可以看出，由于左表中有9条数据，而右表bookinfo中有8条数据，所以左表中的第9条数据，对应的bookinfo显示为NULL;</p><p><strong>情况一</strong>:右表有重复数据的情况</p><p>为了满足条件，需要插入一条重复bookinfo数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO &#96;bookinfo&#96; VALUES (9, &#39;《四世同堂》&#39;, 8, 8, 88);</span><br></pre></td></tr></table></figure><p>测试结果2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM publisher pub LEFT JOIN bookinfo book ON book.publisher_id&#x3D;pub.publisher_id;</span><br><span class="line">+-------------+---------+------+--------------+--------------+-----------+-------+</span><br><span class="line">|publisher_id | name    | id   | name         | publisher_id | author_id | price |</span><br><span class="line">+-------------+---------+------+--------------+--------------+-----------+-------+</span><br><span class="line">|  1 | 经济日报出版社     |1     | 《伯罗奔尼撒战争史》 |    1     |     1 |    11 |</span><br><span class="line">|  2 | 外语教学与研究出版社| 2    | 《茶花女》         |    2     |     2 |    22 |</span><br><span class="line">|  3 | 中国纺织出版社     | 3    | 《对话录》         |    3      |     3 |    22 |</span><br><span class="line">|  4 | 编译出版社        | 4    | 《伦理学》         |    4      |     4 |    44 |</span><br><span class="line">|  5 | 中国言实出版社     | 5    | 《埃涅阿斯记》      |    5     |     5 |    55 |</span><br><span class="line">|  6 | 东方出版社         | 6   | 《希腊罗马英雄史》   |    6     |     6 |    66 |</span><br><span class="line">|  7 | 北京工艺美术出版社 | 7    | 《共产党人的故事》   |    7      |     7 |    77 |</span><br><span class="line">|  8 | 文津出版社         | 8   | 《四世同堂》        |    8      |     8 |    88 |</span><br><span class="line">|  8 | 文津出版社         | 9   | 《四世同堂》        |    8      |     8 |    88 |</span><br><span class="line">|  9 | 新华出版社         | NULL | NULL             | NULL      |  NULL |  NULL |</span><br><span class="line">+-------------+----------+------+-----------------+------------+-----------+-------+</span><br></pre></td></tr></table></figure><p>从上面可以看出，在查询时，由于bookinfo表中有重复的两条，即根据ON条件，publisher_id有2个为8的，所以在返回结果中会出现两条重复的数据，要注意这个问题。</p><h3><span id="3-1-2-duo-biao-lian-jie-cha-xun">3.1.2 多表连结查询</span><a href="#3-1-2-duo-biao-lian-jie-cha-xun" class="header-anchor">#</a></h3><p>为了能够看出多表连结时ON的选用条件不一样，导致的查询结果也不一致的情况，在author表中添加一条数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO &#96;author&#96;(&#96;author_id&#96;, &#96;name&#96;) VALUES (9, &#39;钱钟书&#39;);</span><br></pre></td></tr></table></figure><p>测试结果3：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM publisher pub LEFT JOIN bookinfo book ON book.publisher_id&#x3D;pub.publisher_id</span><br><span class="line">    -&gt; LEFT JOIN author auth ON auth.author_id&#x3D;book.author_id;</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">| publisher_id | name                           | id   | name                           | publisher_id | author_id | price | author_id | name            |</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">|            1 | 经济日报出版社                 |    1 | 《伯罗奔尼撒战争史》           |            1 |         1 |    11 |         1 | 修昔底德        |</span><br><span class="line">|            2 | 外语教学与研究出版社           |    2 | 《茶花女》                     |            2 |         2 |    22 |         2 | 小仲马          |</span><br><span class="line">|            3 | 中国纺织出版社                 |    3 | 《对话录》                     |            3 |         3 |    22 |         3 | 柏拉图          |</span><br><span class="line">|            4 | 编译出版社                     |    4 | 《伦理学》                     |            4 |         4 |    44 |         4 | 亚里士多德      |</span><br><span class="line">|            5 | 中国言实出版社                 |    5 | 《埃涅阿斯记》                 |            5 |         5 |    55 |         5 | 维吉尔          |</span><br><span class="line">|            6 | 东方出版社                     |    6 | 《希腊罗马英雄史》             |            6 |         6 |    66 |         6 | 普鲁塔克        |</span><br><span class="line">|            7 | 北京工艺美术出版社             |    7 | 《共产党人的故事》             |            7 |         7 |    77 |         7 | 徐焰            |</span><br><span class="line">|            8 | 文津出版社                     |    8 | 《四世同堂》                   |            8 |         8 |    88 |         8 | 老舍            |</span><br><span class="line">|            8 | 文津出版社                     |    9 | 《四世同堂》                   |            8 |         8 |    88 |         8 | 老舍            |</span><br><span class="line">|            9 | 新华出版社                     | NULL | NULL                           |         NULL |      NULL |  NULL |      NULL | NULL            |</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">10 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>上面示例的连结条件是：</p><p>以publisher为主表，LEFT JOIN首先连结bookinfo，连结条件book.publisher_id=pub.publisher_id，此时得到的一个表（假使有这个表，实际不会有这个步骤存在）</p><p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/9859ED717ACE4EA68F9608D605E974AA/13930" alt="image"></p><p>然后再用这个中间的大表作为主表，再LEFT JOIN author 表，ON auth.author_id=book.author_id，因为中间表此时是主表，再以这个表的book.author_id去查找，本身自己就是NULL,所以查找的结果还是NULL,见下图</p><p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/54C6D4F680A745918BAD054B4410DC01/13933" alt="最终左连结结果"></p><p>对应的模型如下：</p><p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/5EB39E524BBD41BA9F594B4EAC81D670/13935" alt="模型图"></p><p>测试结果4：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM publisher pub LEFT JOIN bookinfo book ON book.publisher_id&#x3D;pub.publisher_id</span><br><span class="line">    -&gt; LEFT JOIN author auth ON auth.author_id&#x3D;pub.publisher_id;</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">| publisher_id | name                           | id   | name                           | publisher_id | author_id | price | author_id | name            |</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">|            1 | 经济日报出版社                 |    1 | 《伯罗奔尼撒战争史》           |            1 |         1 |    11 |         1 | 修昔底德        |</span><br><span class="line">|            2 | 外语教学与研究出版社           |    2 | 《茶花女》                     |            2 |         2 |    22 |         2 | 小仲马          |</span><br><span class="line">|            3 | 中国纺织出版社                 |    3 | 《对话录》                     |            3 |         3 |    22 |         3 | 柏拉图          |</span><br><span class="line">|            4 | 编译出版社                     |    4 | 《伦理学》                     |            4 |         4 |    44 |         4 | 亚里士多德      |</span><br><span class="line">|            5 | 中国言实出版社                 |    5 | 《埃涅阿斯记》                 |            5 |         5 |    55 |         5 | 维吉尔          |</span><br><span class="line">|            6 | 东方出版社                     |    6 | 《希腊罗马英雄史》             |            6 |         6 |    66 |         6 | 普鲁塔克        |</span><br><span class="line">|            7 | 北京工艺美术出版社             |    7 | 《共产党人的故事》             |            7 |         7 |    77 |         7 | 徐焰            |</span><br><span class="line">|            8 | 文津出版社                     |    8 | 《四世同堂》                   |            8 |         8 |    88 |         8 | 老舍            |</span><br><span class="line">|            8 | 文津出版社                     |    9 | 《四世同堂》                   |            8 |         8 |    88 |         8 | 老舍            |</span><br><span class="line">|            9 | 新华出版社                     | NULL | NULL                           |         NULL |      NULL |  NULL |         9 | 钱钟书          |</span><br><span class="line">+--------------+--------------------------------+------+--------------------------------+--------------+-----------+-------+-----------+-----------------+</span><br><span class="line">10 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>上面示例的连结条件是：</p><p>以publisher为主表，LEFT JOIN首先连结bookinfo，连结条件book.publisher_id=pub.publisher_id，此时得到的一个表，如下</p><p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/9859ED717ACE4EA68F9608D605E974AA/13930" alt="image"></p><p>但是再第二次连结author的时候，继续以publisher表为主表，进行ON auth.author_id=pub.publisher_id，这时候得到的结果如下：</p><p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/E3AF61753F0E45249E70C02238B248B4/13938" alt="结果图片2"></p><p>注意此时连结后的author信息不为空了。</p><p>对应的连结模型如下：</p><p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/35D85B4E70464AF89699C7572B538B0B/13941" alt="模型2"></p><p><strong>总结</strong>：这说明在连结的时候，不同的表作为连结条件，获得的结果会不一样，同时主表的数据会全部展示，但是也可能会多，有可能连结表有重复数据，需要注意。</p><h2><span id="3-2-right-join-you-lian-jie-cha-xun">3.2 RIGHT JOIN 右连结查询</span><a href="#3-2-right-join-you-lian-jie-cha-xun" class="header-anchor">#</a></h2><p><strong>用法</strong>：SELECT XXX  FROM left_table  <strong>RIGHT JOIN</strong> main_table <strong>ON</strong> left_table.key=main_table.key</p><p><strong>解析</strong>：RIGHT JOIN … ON   </p><p>RIGHT JOIN 关键字会右表 (main_table) 那里返回所有的行，即使在左表 ( left_table) 中没有匹配的行。</p><p><strong>注意</strong>：在LEFT JOIN中，左边的表为主表，但是在RIGHT JOIN中，RIGHT JOIN哪个表，哪个表就作为主表，会返回所有的行</p><h3><span id="3-2-1-ji-ben-shi-yong-shi-li">3.2.1 基本使用示例</span><a href="#3-2-1-ji-ben-shi-yong-shi-li" class="header-anchor">#</a></h3><p>这个操作还是在上面表的基础上进行的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM publisher;</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">| publisher_id | name                           |</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">|            1 | 经济日报出版社                 |</span><br><span class="line">|            2 | 外语教学与研究出版社           |</span><br><span class="line">|            3 | 中国纺织出版社                 |</span><br><span class="line">|            4 | 编译出版社                     |</span><br><span class="line">|            5 | 中国言实出版社                 |</span><br><span class="line">|            6 | 东方出版社                     |</span><br><span class="line">|            7 | 北京工艺美术出版社             |</span><br><span class="line">|            8 | 文津出版社                     |</span><br><span class="line">|            9 | 新华出版社                     |</span><br><span class="line">+--------------+--------------------------------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM bookinfo;</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">| id | name                           | publisher_id | author_id | price |</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">|  1 | 《伯罗奔尼撒战争史》           |            1 |         1 |    11 |</span><br><span class="line">|  2 | 《茶花女》                     |            2 |         2 |    22 |</span><br><span class="line">|  3 | 《对话录》                     |            3 |         3 |    22 |</span><br><span class="line">|  4 | 《伦理学》                     |            4 |         4 |    44 |</span><br><span class="line">|  5 | 《埃涅阿斯记》                 |            5 |         5 |    55 |</span><br><span class="line">|  6 | 《希腊罗马英雄史》             |            6 |         6 |    66 |</span><br><span class="line">|  7 | 《共产党人的故事》             |            7 |         7 |    77 |</span><br><span class="line">|  8 | 《四世同堂》                   |            8 |         8 |    88 |</span><br><span class="line">|  9 | 《四世同堂》                   |            8 |         8 |    88 |</span><br><span class="line">+----+--------------------------------+--------------+-----------+-------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>示例使用的SQL如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM bookinfo book RIGHT JOIN publisher pub ON book.publisher_id&#x3D;pub.publisher_id;</span><br></pre></td></tr></table></figure><p>查询结果如下：</p><p><img src="https://note.youdao.com/yws/public/resource/08f2d93624c3197b2b490e255cfcf723/xmlnote/A98AB8B45D04473BBB11B36E9224F4E5/13943" alt="查询结果2"></p><p><strong>总结</strong>：RIGHT JOIN查询的时候用被连结的表publisher作为主表，返回所有数据，RIGHT JOIN左边的就是从表，如果没有匹配到的就展示为NULL.</p><p><strong>其他</strong>：RIGHT JOIN的多表查询情况跟LEFT JOIN类似，这里不再赘述</p><blockquote><p><a href="https://www.w3school.com.cn/sql/sql_join_right.asp" target="_blank" rel="noopener">参考博客</a>  </p><p><a href="https://blog.csdn.net/lp_cq242/article/details/79942457" target="_blank" rel="noopener">参考博客</a>  </p><p><a href="https://www.cnblogs.com/bad-robot/p/9788959.html" target="_blank" rel="noopener">参考博客</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      对MySQL也没有系统的学习，在平时使用MySQL的过程中将遇到的一些知识进行简单的总结，并对其用具体的小例子进行说，并不断完善对MySQL的认识，希望在以后的工作中，对MySQL的使用也会越来越多，包括数据库管理和数据库调优等。
    
    </summary>
    
    
    
      <category term="MySQL" scheme="http://yoursite.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>测试理论</title>
    <link href="http://yoursite.com/2020/02/16/%E6%B5%8B%E8%AF%95%E7%90%86%E8%AE%BA/"/>
    <id>http://yoursite.com/2020/02/16/%E6%B5%8B%E8%AF%95%E7%90%86%E8%AE%BA/</id>
    <published>2020-02-16T04:52:20.000Z</published>
    <updated>2020-02-16T05:25:19.090Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="1-li-lun-ji-chu">1.理论基础</span><a href="#1-li-lun-ji-chu" class="header-anchor">#</a></h1><p>理论基础</p><h1><span id="2-shi-jian">2.实践</span><a href="#2-shi-jian" class="header-anchor">#</a></h1><p>实践</p>]]></content>
    
    <summary type="html">
    
      一片关于测试理论的文章一片关于测试理论的文章一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章，一片关于测试理论的文章一片关于测试理论的文章。
    
    </summary>
    
    
    
      <category term="测试" scheme="http://yoursite.com/tags/%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>github</title>
    <link href="http://yoursite.com/2020/02/16/github/"/>
    <id>http://yoursite.com/2020/02/16/github/</id>
    <published>2020-02-16T04:52:07.000Z</published>
    <updated>2020-02-16T04:52:07.150Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>FastDFS</title>
    <link href="http://yoursite.com/2020/02/16/FastDFS/"/>
    <id>http://yoursite.com/2020/02/16/FastDFS/</id>
    <published>2020-02-16T04:51:55.000Z</published>
    <updated>2020-02-16T04:51:55.371Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>activeMQ</title>
    <link href="http://yoursite.com/2020/02/16/activeMQ/"/>
    <id>http://yoursite.com/2020/02/16/activeMQ/</id>
    <published>2020-02-16T04:51:42.000Z</published>
    <updated>2020-02-16T04:51:42.398Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>spring</title>
    <link href="http://yoursite.com/2020/02/16/spring/"/>
    <id>http://yoursite.com/2020/02/16/spring/</id>
    <published>2020-02-16T04:51:25.000Z</published>
    <updated>2020-02-16T04:51:25.881Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>mongodb</title>
    <link href="http://yoursite.com/2020/02/16/mongodb/"/>
    <id>http://yoursite.com/2020/02/16/mongodb/</id>
    <published>2020-02-16T04:49:14.000Z</published>
    <updated>2020-02-20T08:53:32.231Z</updated>
    
    <content type="html"><![CDATA[<p><a href="mysql.md">mysql.md</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;mysql.md&quot;&gt;mysql.md&lt;/a&gt;&lt;/p&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>springcloud</title>
    <link href="http://yoursite.com/2020/02/16/springcloud/"/>
    <id>http://yoursite.com/2020/02/16/springcloud/</id>
    <published>2020-02-16T04:48:50.000Z</published>
    <updated>2020-02-16T04:48:50.288Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>java基础</title>
    <link href="http://yoursite.com/2020/02/16/java%E5%9F%BA%E7%A1%80/"/>
    <id>http://yoursite.com/2020/02/16/java%E5%9F%BA%E7%A1%80/</id>
    <published>2020-02-16T04:48:36.000Z</published>
    <updated>2020-02-16T04:48:36.892Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>python</title>
    <link href="http://yoursite.com/2020/02/16/python/"/>
    <id>http://yoursite.com/2020/02/16/python/</id>
    <published>2020-02-16T04:46:25.000Z</published>
    <updated>2020-02-16T04:47:26.637Z</updated>
    
    <content type="html"><![CDATA[<p>[toc]</p><h1><span id="1-jian-jie">1.简介</span><a href="#1-jian-jie" class="header-anchor">#</a></h1><p>python简介</p><h1><span id="2-python-an-zhuang">2.Python安装</span><a href="#2-python-an-zhuang" class="header-anchor">#</a></h1><p>安装Python</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[toc]&lt;/p&gt;
&lt;h1&gt;&lt;span id=&quot;1-jian-jie&quot;&gt;1.简介&lt;/span&gt;&lt;a href=&quot;#1-jian-jie&quot; class=&quot;header-anchor&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;python简介&lt;/p&gt;
&lt;h1&gt;&lt;span id=&quot;2-pyth
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Pandas基础</title>
    <link href="http://yoursite.com/2020/02/15/Pandas%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2020/02/15/Pandas%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/</id>
    <published>2020-02-15T14:35:26.195Z</published>
    <updated>2020-02-19T12:47:36.344Z</updated>
    
    <content type="html"><![CDATA[<div class="toc"><!-- toc --><ul><li><a href="#1-an-zhuang">1.安装</a></li><li><a href="#2-pandas-huo-qu-csv-excel-de-di-yi-xing-lie-biao-qian">2.pandas获取csv\Excel的第一行（列标签）</a></li><li><a href="#3-huo-qu-excel-de-zui-da-xing-he-zui-da-lie">3.获取excel的最大行和最大列</a></li><li><a href="#4-xian-shi-lie-ming-ji-dui-ying-xu-hao">4.显示列名及对应序号</a></li><li><a href="#5-da-yin-zhi-ding-dan-yuan-ge">5.打印指定单元格</a></li><li><a href="#6-gen-ju-lie-ming-cha-kan-lie-de-nei-rong">6.根据列名查看列的内容</a></li><li><a href="#7-gen-ju-lie-de-xu-hao-cha-kan-zhi-ding-lie-nei-rong">7.根据列的序号查看指定列内容</a></li><li><a href="#8-cha-kan-gu-ding-xing-de-nei-rong">8.查看固定行的内容</a></li><li><a href="#9-bian-li-zheng-ge-biao-ge">9.遍历整个表格</a></li><li><a href="#10-du-qu-excel-shi-dai-lie-ming-du-qu">10.读取excel时带列名读取</a></li><li><a href="#11-cao-zuo-excel-cha-ru-lie">11.操作excel插入列</a><ul><li><a href="#11-1-cha-ru-xing-lie-cao-zuo">11.1 插入行列操作</a></li><li><a href="#11-2-cha-ru-shi-zuo-bian-duo-yi-lie-de-wen-ti">11.2 插入时左边多一列的问题</a></li><li><a href="#11-3-she-zhi-lie-kuan">11.3设置列宽</a><ul><li><a href="#11-3-1-shi-ji-shi-yong-de-yi-ge-cheng-xu-li-zi">11.3.1 实际使用的一个程序例子</a></li></ul></li></ul></li></ul><!-- tocstop --></div># 1.安装pandas处理excel需要xlrd、openpyxl依赖包<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install pandas</span><br><span class="line">pip install xlrd</span><br><span class="line">pip install openpyxl</span><br></pre></td></tr></table></figure><h1><span id="2-pandas-huo-qu-csv-excel-de-di-yi-xing-lie-biao-qian">2.pandas获取csv\Excel的第一行（列标签）</span><a href="#2-pandas-huo-qu-csv-excel-de-di-yi-xing-lie-biao-qian" class="header-anchor">#</a></h1><p>一般来说excel第一行是列标签，平时读取第一行也是从数据行来读取的，那么如何读取第一行列标签呢  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import pandas as pd</span><br><span class="line">&gt;&gt;&gt; path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line">&gt;&gt;&gt; data&#x3D;pd.read_excel(path)</span><br><span class="line">&gt;&gt;&gt; list(data.columns.values)</span><br></pre></td></tr></table></figure><p>这样就能拿到所有的列标签</p><h1><span id="3-huo-qu-excel-de-zui-da-xing-he-zui-da-lie">3.获取excel的最大行和最大列</span><a href="#3-huo-qu-excel-de-zui-da-xing-he-zui-da-lie" class="header-anchor">#</a></h1><p>==注意：这里获取到的行是不包括第一行（标签名）==<br><img src="1C4585815AB14373B3B97CB11FAFC2C7" alt="image"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import pandas as pd</span><br><span class="line">&gt;&gt;&gt; path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line">&gt;&gt;&gt; data&#x3D;pd.read_excel(path)</span><br><span class="line">#获取最大行，不包括标签</span><br><span class="line">&gt;&gt;&gt; nrows&#x3D;data.shape[0]</span><br><span class="line">5  </span><br><span class="line">#获取最大列</span><br><span class="line">&gt;&gt;&gt; ncols&#x3D;data.columns.size</span><br><span class="line">100</span><br><span class="line"></span><br><span class="line">print(&#39;Max Rows:&#39;+str(nrows))</span><br><span class="line">print(&#39;Max Columns&#39;+str(ncols))</span><br></pre></td></tr></table></figure><h1><span id="4-xian-shi-lie-ming-ji-dui-ying-xu-hao">4.显示列名及对应序号</span><a href="#4-xian-shi-lie-ming-ji-dui-ying-xu-hao" class="header-anchor">#</a></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line"></span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line"></span><br><span class="line">data&#x3D;pd.read_excel(path)</span><br><span class="line">nrows&#x3D;data.shape[0]</span><br><span class="line">ncols&#x3D;data.columns.size</span><br><span class="line"></span><br><span class="line">#显示列名，并显示列名序号</span><br><span class="line">for iCol in range(ncols):</span><br><span class="line">    print(str(iCol)+&quot;:&quot;+data.columns[iCol])</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0:Chr</span><br><span class="line">1:Start</span><br><span class="line">2:Stop</span><br><span class="line">3:Ref</span><br><span class="line">4:Call</span><br><span class="line">5:MapLoc</span><br></pre></td></tr></table></figure><h1><span id="5-da-yin-zhi-ding-dan-yuan-ge">5.打印指定单元格</span><a href="#5-da-yin-zhi-ding-dan-yuan-ge" class="header-anchor">#</a></h1><p><img src="4AA58F982DA348FAA4D1E323D800732F" alt="image"><br>打印第二行，第四列  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line"></span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line"></span><br><span class="line">data&#x3D;pd.read_excel(path)</span><br><span class="line">nrows&#x3D;data.shape[0]</span><br><span class="line">ncols&#x3D;data.columns.size</span><br><span class="line"></span><br><span class="line">#打印指定单元格</span><br><span class="line">print(data.iloc[0,3])</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C  #打印正确</span><br></pre></td></tr></table></figure><h1><span id="6-gen-ju-lie-ming-cha-kan-lie-de-nei-rong">6.根据列名查看列的内容</span><a href="#6-gen-ju-lie-ming-cha-kan-lie-de-nei-rong" class="header-anchor">#</a></h1><p><img src="CC19CF513A0D4673ABBDAA1E2038A5F9" alt="image">  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line"></span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line">data&#x3D;pd.read_excel(path)</span><br><span class="line">#查看指定列的内容</span><br><span class="line">print(data[&#39;Ref&#39;])</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0    C</span><br><span class="line">1    T</span><br><span class="line">2    G</span><br><span class="line">3    G</span><br><span class="line">4    G</span><br><span class="line">Name: Ref, dtype: object</span><br></pre></td></tr></table></figure><h1><span id="7-gen-ju-lie-de-xu-hao-cha-kan-zhi-ding-lie-nei-rong">7.根据列的序号查看指定列内容</span><a href="#7-gen-ju-lie-de-xu-hao-cha-kan-zhi-ding-lie-nei-rong" class="header-anchor">#</a></h1><p><img src="095D5A4B7E0F4484A28B3A97F3D707CE" alt="image"><br><strong>方法一</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line">data&#x3D;pd.read_excel(path)</span><br><span class="line">#根据列的序号查看指定列:第四列的内容</span><br><span class="line">sColumnName&#x3D;data.columns[3]</span><br><span class="line">print(data[sColumnName])</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0    C</span><br><span class="line">1    T</span><br><span class="line">2    G</span><br><span class="line">3    G</span><br><span class="line">4    G</span><br><span class="line">Name: Ref, dtype: object</span><br></pre></td></tr></table></figure><p><strong>方法二</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line">data&#x3D;pd.read_excel(path,sheet_name&#x3D;&quot;SmallVariations&quot;)</span><br><span class="line">#查看某一列的值</span><br><span class="line">print(data[&#39;Ref&#39;].values)</span><br></pre></td></tr></table></figure><p>这种方法更为简便，注意读取excel时如果要用这种方法，就不能添加header=None,不然会报错，运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#39;C&#39; &#39;T&#39; &#39;G&#39; &#39;G&#39; &#39;G&#39;]</span><br></pre></td></tr></table></figure><h1><span id="8-cha-kan-gu-ding-xing-de-nei-rong">8.查看固定行的内容</span><a href="#8-cha-kan-gu-ding-xing-de-nei-rong" class="header-anchor">#</a></h1><p><img src="482C157BF6254D03B5C20817EE2EECF8" alt="image"><br><strong>方法一</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line">data&#x3D;pd.read_excel(path)</span><br><span class="line">nrows&#x3D;data.shape[0]</span><br><span class="line">ncols&#x3D;data.columns.size</span><br><span class="line">#查看某行的内容(第四行，行从0开始)</span><br><span class="line">iRow&#x3D;3</span><br><span class="line">for iCol in range(ncols):</span><br><span class="line">    print(data.iloc[iRow,iCol])</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">11190610</span><br><span class="line">11190611</span><br><span class="line">G</span><br><span class="line">A</span><br><span class="line">1p36.22</span><br><span class="line">snv</span><br><span class="line">SomMajor</span><br><span class="line">NDPLow</span><br><span class="line">...</span><br><span class="line">..</span><br></pre></td></tr></table></figure><p><strong>方法二</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line">data&#x3D;pd.read_excel(path,sheet_name&#x3D;&quot;SmallVariations&quot;,header&#x3D;None)</span><br><span class="line"># 查看第一行</span><br><span class="line">print(data.values[0])</span><br></pre></td></tr></table></figure><p>这种方法更为简便，运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[&#39;Chr&#39; &#39;Start&#39; &#39;Stop&#39; &#39;Ref&#39; &#39;Call&#39; &#39;MapLoc&#39; &#39;VarType&#39; &#39;VarTag&#39;</span><br><span class="line"> &#39;siteFilter&#39; &#39;SomConfLev&#39; &#39;SomNotes&#39; &#39;caseRsAD&#39; &#39;caseAD&#39; &#39;caseAF&#39;</span><br><span class="line"> &#39;caseDP&#39;..]</span><br></pre></td></tr></table></figure><h1><span id="9-bian-li-zheng-ge-biao-ge">9.遍历整个表格</span><a href="#9-bian-li-zheng-ge-biao-ge" class="header-anchor">#</a></h1><p><strong>方法一</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line">data&#x3D;pd.read_excel(path)</span><br><span class="line">nrows&#x3D;data.shape[0]</span><br><span class="line">ncols&#x3D;data.columns.size</span><br><span class="line">#遍历整个表格</span><br><span class="line">for iRow in range(nrows):</span><br><span class="line">    for iCol in range(ncols):</span><br><span class="line">        print(data.iloc[iRow,iCol])</span><br></pre></td></tr></table></figure><p><strong>方法二</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line">data&#x3D;pd.read_excel(path,sheet_name&#x3D;&quot;SmallVariations&quot;,header&#x3D;None)</span><br><span class="line"># 查看所有的值</span><br><span class="line">print(data.values)</span><br></pre></td></tr></table></figure><p>这种方法更为直观、简便，运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[&#39;Chr&#39; &#39;Start&#39; &#39;Stop&#39; &#39;Ref&#39; &#39;Call&#39; &#39;MapLoc&#39; &#39;VarType&#39; &#39;VarTag&#39;</span><br><span class="line">  &#39;siteFilter&#39; &#39;SomConfLev&#39; &#39;SomNotes&#39; &#39;caseRsAD&#39; &#39;caseAD&#39; &#39;caseAF&#39;</span><br><span class="line">  &#39;caseDP&#39; ..]]</span><br></pre></td></tr></table></figure><h1><span id="10-du-qu-excel-shi-dai-lie-ming-du-qu">10.读取excel时带列名读取</span><a href="#10-du-qu-excel-shi-dai-lie-ming-du-qu" class="header-anchor">#</a></h1><p>读取时增加参数：header=None</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test.xlsx&quot;</span><br><span class="line">data&#x3D;pd.read_excel(path,sheet_name&#x3D;&quot;SmallVariations&quot;,header&#x3D;None)</span><br><span class="line">nrows&#x3D;data.shape[0]</span><br><span class="line">ncols&#x3D;data.columns.size</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Max Rows:6   &#x2F;&#x2F;比上面的读取多了一行</span><br><span class="line">Max Columns:100</span><br></pre></td></tr></table></figure><h1><span id="11-cao-zuo-excel-cha-ru-lie">11.操作excel插入列</span><a href="#11-cao-zuo-excel-cha-ru-lie" class="header-anchor">#</a></h1><p><img src="6B542D80AF324DE3AC9AAB0A5473257B" alt="image">  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test2.xlsx&quot;</span><br><span class="line">data&#x3D;pd.read_excel(path,sheet_name&#x3D;&quot;shtt1&quot;)</span><br><span class="line"></span><br><span class="line"># 新增列</span><br><span class="line">tmp&#x3D;data[&#39;Stop&#39;].values</span><br><span class="line">data.insert(6,&#39;Stop2&#39;,tmp)</span><br><span class="line">pd.DataFrame(data).to_excel(&quot;I:\\download\\临时\\test2.xlsx&quot;,sheet_name&#x3D;&quot;shtt1&quot;,index&#x3D;False,header&#x3D;True)</span><br></pre></td></tr></table></figure><p>操作结果：<br><img src="976CFFFF1A494C8BA6F0D4CE68A19B94" alt="image"></p><h2><span id="11-1-cha-ru-xing-lie-cao-zuo">11.1 插入行列操作</span><a href="#11-1-cha-ru-xing-lie-cao-zuo" class="header-anchor">#</a></h2><p><img src="DFAFFC7EC62843159D17BAB68E2DE044" alt="image">  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">path&#x3D;&quot;I:\\download\\临时\\test2.xlsx&quot;</span><br><span class="line">data&#x3D;pd.read_excel(path,sheet_name&#x3D;&quot;sheet1&quot;)</span><br><span class="line">newrow&#x3D;[&#39;孙悟空&#39;,&#39;沙僧&#39;,&#39;八戒&#39;,&#39;小白龙&#39;]</span><br><span class="line">#增加行数据，在第6行增加</span><br><span class="line">data.loc[6]&#x3D;newrow</span><br><span class="line"></span><br><span class="line">#增加列，给定默认值None</span><br><span class="line">data[&#39;成绩&#39;]&#x3D;None</span><br><span class="line"></span><br><span class="line">#列变动后再插入行</span><br><span class="line">newrow2&#x3D;[&#39;孙悟空&#39;,&#39;沙僧&#39;,&#39;八戒&#39;,&#39;小白龙&#39;,&#39;90&#39;]</span><br><span class="line">data.loc[7]&#x3D;newrow2</span><br><span class="line">pd.DataFrame(data).to_excel(&quot;I:\\download\\临时\\test2.xlsx&quot;,sheet_name&#x3D;&quot;sheet1&quot;,index&#x3D;False,header&#x3D;True)</span><br></pre></td></tr></table></figure><p>执行结果：<br><img src="6D4569B051094B6DAF09623018E196DA" alt="image"></p><h2><span id="11-2-cha-ru-shi-zuo-bian-duo-yi-lie-de-wen-ti">11.2 插入时左边多一列的问题</span><a href="#11-2-cha-ru-shi-zuo-bian-duo-yi-lie-de-wen-ti" class="header-anchor">#</a></h2><p><img src="BBE51733BDC04E65BDDC421AE3ACF420" alt="image"><br>使用如下代码编辑后，结果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data &#x3D; pd.read_excel(path)</span><br><span class="line">pd.DataFrame(data).to_excel(path, sheet_name&#x3D;&quot;Sheet1&quot;, header&#x3D;True)</span><br></pre></td></tr></table></figure><p>执行结果后结果如下：<br><img src="C1101BA003A24196A2733195C74D2932" alt="image"><br>解决方法：<br>在进行to_excel操作的时候加上参数<strong>index=False</strong>，如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">pd.DataFrame(data).to_excel(path, sheet_name&#x3D;&quot;Sheet1&quot;,index&#x3D;False, header&#x3D;True)</span><br></pre></td></tr></table></figure><p><img src="F99ECDFCBCD54EFCA99D22F645B87E8E" alt="image">   </p><h2><span id="11-3-she-zhi-lie-kuan">11.3设置列宽</span><a href="#11-3-she-zhi-lie-kuan" class="header-anchor">#</a></h2><p>原始的表格如果列宽不够的话，会隐藏显示，如下图：<br><img src="1584F3D1E0534424815682EEB45CAC97" alt="image"><br>那么如何设置列宽度呢，参见如下代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#创建一个空的Excel</span><br><span class="line">path&#x3D;&quot;I:\\download\\zz.xlsx&quot;</span><br><span class="line"></span><br><span class="line">data &#x3D; pd.read_excel(path)</span><br><span class="line">df &#x3D; pd.DataFrame(data)</span><br><span class="line"></span><br><span class="line"># Create a Pandas Excel writer using XlsxWriter as the engine.</span><br><span class="line">writer &#x3D; pd.ExcelWriter(path, engine&#x3D;&#39;xlsxwriter&#39;)</span><br><span class="line"></span><br><span class="line"># Convert the dataframe to an XlsxWriter Excel object.这里注意index要设置为false，不然结果会多一列数据</span><br><span class="line">df.to_excel(writer, sheet_name&#x3D;&#39;Sheet1&#39;, index&#x3D;False)</span><br><span class="line"></span><br><span class="line"># Get the xlsxwriter objects from the dataframe writer object.</span><br><span class="line">workbook &#x3D; writer.book</span><br><span class="line">worksheet &#x3D; writer.sheets[&#39;Sheet1&#39;]</span><br><span class="line"></span><br><span class="line"># Add some cell formats.</span><br><span class="line">format1 &#x3D; workbook.add_format(&#123;&quot;font_name&quot;: u&quot;微软雅黑&quot;&#125;)</span><br><span class="line"></span><br><span class="line"># Set the column width and format.</span><br><span class="line">worksheet.set_column(&#39;A:B&#39;, 18, format1)</span><br><span class="line">worksheet.set_column(&#39;C:H&#39;, 21, format1)</span><br><span class="line">df.to_excel(path, sheet_name&#x3D;&quot;Sheet1&quot;, index&#x3D;False, header&#x3D;True)</span><br><span class="line">writer.save()</span><br></pre></td></tr></table></figure><p><img src="2B0BBD5F71594E73B714FC09070CAA97" alt="image">  </p><h3><span id="11-3-1-shi-ji-shi-yong-de-yi-ge-cheng-xu-li-zi">11.3.1 实际使用的一个程序例子</span><a href="#11-3-1-shi-ji-shi-yong-de-yi-ge-cheng-xu-li-zi" class="header-anchor">#</a></h3><p>从数据库中用以下SQL将查询出来的数据写入到EXCEL中，并设置列宽  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select trim(BOTH &#39;&quot;&#39; FROM json_extract(esi.fdynamic_attribute,&#39;$.f31&#39;)) as &#39;RUN号&#39;,qc.fsample_code as &#39;样本编号&#39;,</span><br><span class="line">ai.fsubmit_time as &#39;提交时间&#39;,ai.fstart_time as &#39;分析开始时间&#39;,ai.ffinish_time as &#39;分析结束时间&#39;,ai.felapsed_time as &#39;运行耗时&#39;,</span><br><span class="line">trim(BOTH &#39;&quot;&#39; FROM json_extract(rinfo.fdynamic_attribute,&#39;$.f50&#39;)) as &#39;审核时间&#39;,trim(BOTH &#39;&quot;&#39; FROM json_extract(rinfo.fdynamic_attribute,&#39;$.f72&#39;)) as &#39;报告时间&#39; from a_info ai</span><br><span class="line">LEFT JOIN e_sequence_detail esd on (ai.fsequence_detail_id&#x3D;esd.fid)</span><br><span class="line">LEFT JOIN e_sequence_info esi on (esi.fid&#x3D;esd.fsequence_id)</span><br><span class="line">LEFT JOIN qc_info qc on (ai.fid&#x3D;qc.finfo_id)</span><br><span class="line">LEFT JOIN r_info rinfo on (rinfo.fqc_id&#x3D;qc.fid)</span><br><span class="line">where trim(BOTH &#39;&quot;&#39; FROM json_extract(esi.fdynamic_attribute,&#39;$.f31&#39;)) &#x3D;&#39;F300000337&#39;;</span><br></pre></td></tr></table></figure><p><img src="4DD67888E2E3402CADED2AFA0AE1761B" alt="image"><br>编写的Python程序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;evn python</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">import pandas as pd</span><br><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Export(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.data &#x3D; pd.read_excel(&quot;I:\\download\\zz.xlsx&quot;, sheet_name&#x3D;&quot;Sheet1&quot;)</span><br><span class="line">        self.data[&#39;RUN号&#39;] &#x3D; None</span><br><span class="line">        self.data[&#39;样本编号&#39;] &#x3D; None</span><br><span class="line">        self.data[&#39;提交时间&#39;] &#x3D; None</span><br><span class="line">        self.data[&#39;分析开始时间&#39;] &#x3D; None</span><br><span class="line">        self.data[&#39;分析结束时间&#39;] &#x3D; None</span><br><span class="line">        self.data[&#39;运行耗时&#39;] &#x3D; None</span><br><span class="line">        self.data[&#39;审核时间&#39;] &#x3D; None</span><br><span class="line">        self.data[&#39;报告时间&#39;] &#x3D; None</span><br><span class="line"></span><br><span class="line">    def connect(self):</span><br><span class="line">        db &#x3D;pymysql.connect(&#39;127.0.0.1&#39; ,&#39;root&#39; ,&#39;123456&#39; ,&#39;oncoosplus_zhongzhong&#39; ,use_unicode&#x3D;True, charset&#x3D;&#39;utf8&#39;)</span><br><span class="line">        cursor &#x3D;db.cursor()</span><br><span class="line">        return cursor ,db</span><br><span class="line"></span><br><span class="line">    def getdata(self,runcode):</span><br><span class="line">        cursor,db &#x3D; self.connect()</span><br><span class="line">        sql&#x3D;&#39;&#39;&#39;</span><br><span class="line">        select trim(BOTH &#39;&quot;&#39; FROM json_extract(esi.fdynamic_attribute,&#39;$.f31&#39;)) as &#39;RUN号&#39;,qc.fsample_code as &#39;样本编号&#39;, ai.fsubmit_time as &#39;提交时间&#39;,ai.fstart_time as &#39;分析开始时间&#39;,ai.ffinish_time as &#39;分析结束时间&#39;,ai.felapsed_time as &#39;运行耗时&#39;, trim(BOTH &#39;&quot;&#39; FROM json_extract(rinfo.fdynamic_attribute,&#39;$.f50&#39;)) as &#39;审核时间&#39;,trim(BOTH &#39;&quot;&#39; FROM json_extract(rinfo.fdynamic_attribute,&#39;$.f72&#39;)) as &#39;报告时间&#39; from a_info ai LEFT JOIN e_sequence_detail esd on (ai.fsequence_detail_id&#x3D;esd.fid) LEFT JOIN e_sequence_info esi on (esi.fid&#x3D;esd.fsequence_id) LEFT JOIN qc_info qc on (ai.fid&#x3D;qc.finfo_id) LEFT JOIN r_info rinfo on (rinfo.fqc_id&#x3D;qc.fid) where trim(BOTH &#39;&quot;&#39; FROM json_extract(esi.fdynamic_attribute,&#39;$.f31&#39;)) &#x3D;</span><br><span class="line">        &#39;&#39;&#39;</span><br><span class="line">        cursor.execute(sql+&quot;&#39;&quot;+runcode+&quot;&#39;;&quot;)</span><br><span class="line">        # print(sql+runcode+&quot;&#39;;&quot;)</span><br><span class="line">        # print(cursor.fetchall())</span><br><span class="line">        for i,item in enumerate(cursor.fetchall()):</span><br><span class="line">            self.data.loc[i+1] &#x3D; item ##插入行数据</span><br><span class="line">        df &#x3D; pd.DataFrame(self.data) #.to_excel(&quot;I:\\download\\zz.xlsx&quot;, sheet_name&#x3D;&quot;Sheet1&quot;, index&#x3D;False, header&#x3D;True)</span><br><span class="line">        self.setFormat(df)</span><br><span class="line"></span><br><span class="line">    def setFormat(self,df):</span><br><span class="line">        # df &#x3D; pd.DataFrame(self.data)</span><br><span class="line"></span><br><span class="line">        # Create a Pandas Excel writer using XlsxWriter as the engine.</span><br><span class="line">        writer &#x3D; pd.ExcelWriter(&#39;I:\\download\\zz.xlsx&#39;, engine&#x3D;&#39;xlsxwriter&#39;)</span><br><span class="line"></span><br><span class="line">        # Convert the dataframe to an XlsxWriter Excel object.</span><br><span class="line">        df.to_excel(writer, sheet_name&#x3D;&#39;Sheet1&#39;,index&#x3D;False)</span><br><span class="line"></span><br><span class="line">        # Get the xlsxwriter objects from the dataframe writer object.</span><br><span class="line">        workbook &#x3D; writer.book</span><br><span class="line">        worksheet &#x3D; writer.sheets[&#39;Sheet1&#39;]</span><br><span class="line"></span><br><span class="line">        # Add some cell formats.</span><br><span class="line">        format1 &#x3D; workbook.add_format(&#123;&quot;font_name&quot;: u&quot;微软雅黑&quot;&#125;)</span><br><span class="line"></span><br><span class="line">        # Set the column width and format.</span><br><span class="line">        worksheet.set_column(&#39;A:B&#39;, 18, format1)</span><br><span class="line">        worksheet.set_column(&#39;C:H&#39;, 20, format1)</span><br><span class="line">        df.to_excel(&quot;I:\\download\\zz.xlsx&quot;, sheet_name&#x3D;&quot;Sheet1&quot;, index&#x3D;False, header&#x3D;True)</span><br><span class="line">        writer.save()</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    #创建一个空的Excel</span><br><span class="line">    path&#x3D;&quot;I:\\download\\zz.xlsx&quot;</span><br><span class="line">    df &#x3D; pd.DataFrame()</span><br><span class="line">    df.to_excel(&quot;I:\\download\\zz.xlsx&quot;)</span><br><span class="line">    </span><br><span class="line">    export&#x3D;Export()</span><br><span class="line">    export.getdata(&quot;F300000337&quot;)</span><br></pre></td></tr></table></figure><p>执行结果：<br><img src="46F2BCCE4AF84882BBC42681B673A797" alt="image"></p><blockquote><p><a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html" target="_blank" rel="noopener">pandas官方文档</a><br><a href="https://www.pypandas.cn" target="_blank" rel="noopener">pandas中文文档</a><br><a href="https://blog.csdn.net/xufankang/article/details/83688379" target="_blank" rel="noopener">获取列标签参考博客</a><br><a href="https://www.cnblogs.com/SH170706/p/10568908.html" target="_blank" rel="noopener">pandas基础操作参考博客</a><br><a href="https://www.jianshu.com/p/7df2593a01ce" target="_blank" rel="noopener">excel插入列参考博客</a><br><a href="https://blog.csdn.net/qq_34377830/article/details/81872568" target="_blank" rel="noopener">excel插入列保存参考博客</a><br><a href="https://www.jb51.net/article/174537.htm" target="_blank" rel="noopener">操作列参考博客</a><br><a href="https://blog.csdn.net/guotong1988/article/details/80513879?utm_source=blogxgwz1" target="_blank" rel="noopener">左边多一列参考博客</a><br><a href="https://xlsxwriter.readthedocs.io/working_with_pandas.html" target="_blank" rel="noopener">设置列宽参考官方文档</a><br><a href="https://www.lizenghai.com/archives/37618.html" target="_blank" rel="noopener">设置列宽参考博客</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;toc&quot;&gt;

&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-an-zhuang&quot;&gt;1.安装&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2-pandas-huo-qu-csv-excel-de-di-yi-xing-lie-bia
      
    
    </summary>
    
    
      <category term="Python库" scheme="http://yoursite.com/categories/Python%E5%BA%93/"/>
    
    
      <category term="Python" scheme="http://yoursite.com/tags/Python/"/>
    
  </entry>
  
</feed>
